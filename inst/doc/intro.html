<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="19003" />

<meta name="date" content="2020-01-01" />

<title>Introduction to SC19003</title>

<script>$(document).ready(function(){
    if (typeof $('[data-toggle="tooltip"]').tooltip === 'function') {
        $('[data-toggle="tooltip"]').tooltip();
    }
    if ($('[data-toggle="popover"]').popover === 'function') {
        $('[data-toggle="popover"]').popover();
    }
});
</script>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#header {
text-align: center;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; }  code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Introduction to SC19003</h1>
<h4 class="author">19003</h4>
<h4 class="date">2020-01-01</h4>



<div id="overview" class="section level2">
<h2>Overview</h2>
<p><strong>SC19003</strong> is a simple R package developed to calculate the main quantitative metric describing the queuing system in the queuing service system. These are the length of the queue (Ls), the average waiting time of the customer and the average stay time (Ws), and whether the system is busy. During simulation, there are three key variables: time variable, counting variable, and system state variable. The time variable mainly records the arrival or departure of customers. The counting variable records the number of customers in the service system. The system state variable mainly records the number of customers in the system and which service desk they are at. In queued service systems, it is usually assumed that the successive arrival intervals of customers to the system are independent and subject to an exponential distribution with a parameter of <span class="math inline">\(\lambda\)</span>. The service time of the service desk is also iid., and obeys the exponential distribution of parameter <span class="math inline">\(\mu\)</span>. Queues are allowed forever. Two functions are considered, namely, <em>quene1</em> (Assuming that there is only one service counters) and <em>queue2</em> (Assuming that the number of service counters is greater than 1).</p>
<p>The source R code for <em>queue1</em> is as follows:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1">queue1&lt;-<span class="cf">function</span>(lambda, mu, T){</a>
<a class="sourceLine" id="cb1-2" title="2">  k&lt;-<span class="dv">0</span>; wt&lt;-<span class="dv">0</span>; wn&lt;-<span class="dv">0</span>; ws&lt;-<span class="dv">0</span>;</a>
<a class="sourceLine" id="cb1-3" title="3">  tp&lt;-<span class="dv">0</span>; nA&lt;-<span class="dv">0</span>; n&lt;-<span class="dv">0</span>; t&lt;-<span class="dv">0</span></a>
<a class="sourceLine" id="cb1-4" title="4">  r&lt;-<span class="kw">runif</span>(<span class="dv">1</span>); tA&lt;-<span class="op">-</span><span class="dv">1</span><span class="op">/</span>lambda<span class="op">*</span><span class="kw">log</span>(r); tD&lt;-<span class="ot">Inf</span></a>
<a class="sourceLine" id="cb1-5" title="5">  <span class="cf">repeat</span>{</a>
<a class="sourceLine" id="cb1-6" title="6">    k&lt;-k<span class="op">+</span><span class="dv">1</span>; wt[k]&lt;-t; wn[k]&lt;-n</a>
<a class="sourceLine" id="cb1-7" title="7">    <span class="cf">if</span> (tA <span class="op">&lt;</span><span class="st"> </span>T){</a>
<a class="sourceLine" id="cb1-8" title="8">      ws[k]&lt;-<span class="kw">min</span>(tA, tD)<span class="op">-</span>t</a>
<a class="sourceLine" id="cb1-9" title="9">      <span class="cf">if</span> (tA <span class="op">&lt;</span><span class="st"> </span>tD){</a>
<a class="sourceLine" id="cb1-10" title="10">        t&lt;-tA; n&lt;-n<span class="op">+</span><span class="dv">1</span>; nA&lt;-nA<span class="op">+</span><span class="dv">1</span></a>
<a class="sourceLine" id="cb1-11" title="11">        r&lt;-<span class="kw">runif</span>(<span class="dv">1</span>); tA&lt;-t<span class="dv">-1</span><span class="op">/</span>lambda<span class="op">*</span><span class="kw">log</span>(r)</a>
<a class="sourceLine" id="cb1-12" title="12">        <span class="cf">if</span> (n<span class="op">==</span><span class="dv">1</span>){</a>
<a class="sourceLine" id="cb1-13" title="13">          r&lt;-<span class="kw">runif</span>(<span class="dv">1</span>); tD&lt;-t<span class="dv">-1</span><span class="op">/</span>mu<span class="op">*</span><span class="kw">log</span>(r)</a>
<a class="sourceLine" id="cb1-14" title="14">        }</a>
<a class="sourceLine" id="cb1-15" title="15">      }<span class="cf">else</span>{</a>
<a class="sourceLine" id="cb1-16" title="16">        t&lt;-tD; n&lt;-n<span class="dv">-1</span></a>
<a class="sourceLine" id="cb1-17" title="17">        <span class="cf">if</span> (n<span class="op">==</span><span class="dv">0</span>){</a>
<a class="sourceLine" id="cb1-18" title="18">          tD&lt;-<span class="ot">Inf</span></a>
<a class="sourceLine" id="cb1-19" title="19">        }<span class="cf">else</span>{</a>
<a class="sourceLine" id="cb1-20" title="20">          r&lt;-<span class="kw">runif</span>(<span class="dv">1</span>); tD&lt;-t<span class="dv">-1</span><span class="op">/</span>mu<span class="op">*</span><span class="kw">log</span>(r)</a>
<a class="sourceLine" id="cb1-21" title="21">        } }</a>
<a class="sourceLine" id="cb1-22" title="22">    }<span class="cf">else</span>{</a>
<a class="sourceLine" id="cb1-23" title="23">      ws[k]&lt;-<span class="cf">if</span>(tD<span class="op">==</span><span class="ot">Inf</span>) <span class="dv">0</span> <span class="cf">else</span> tD<span class="op">-</span>t</a>
<a class="sourceLine" id="cb1-24" title="24">      <span class="cf">if</span> (n<span class="op">&gt;</span><span class="dv">0</span>){</a>
<a class="sourceLine" id="cb1-25" title="25">        t&lt;-tD; n&lt;-n<span class="dv">-1</span></a>
<a class="sourceLine" id="cb1-26" title="26">        <span class="cf">if</span> (n<span class="op">&gt;</span><span class="dv">0</span>){</a>
<a class="sourceLine" id="cb1-27" title="27">          r&lt;-<span class="kw">runif</span>(<span class="dv">1</span>); tD&lt;-t<span class="dv">-1</span><span class="op">/</span>mu<span class="op">*</span><span class="kw">log</span>(r)</a>
<a class="sourceLine" id="cb1-28" title="28">        }</a>
<a class="sourceLine" id="cb1-29" title="29">      }<span class="cf">else</span></a>
<a class="sourceLine" id="cb1-30" title="30">        tp&lt;-<span class="dv">1</span></a>
<a class="sourceLine" id="cb1-31" title="31">    }</a>
<a class="sourceLine" id="cb1-32" title="32">    </a>
<a class="sourceLine" id="cb1-33" title="33">    <span class="cf">if</span> (tp<span class="op">==</span><span class="dv">1</span>) <span class="cf">break</span></a>
<a class="sourceLine" id="cb1-34" title="34">  }</a>
<a class="sourceLine" id="cb1-35" title="35">  <span class="kw">data.frame</span>(<span class="dt">Ls=</span><span class="kw">sum</span>(ws<span class="op">*</span>wn)<span class="op">/</span>t, <span class="dt">Ws=</span><span class="kw">sum</span>(ws<span class="op">*</span>wn)<span class="op">/</span>nA,</a>
<a class="sourceLine" id="cb1-36" title="36">             <span class="dt">Pwait=</span><span class="kw">sum</span>(ws[wn<span class="op">&gt;=</span><span class="dv">1</span>])<span class="op">/</span>t)</a>
<a class="sourceLine" id="cb1-37" title="37">}</a></code></pre></div>
<p>Suppose a maintenance center only arranges for one employee to provide services on weekends. It is assumed that the arrival process of customers for maintenance is Possion flow, with an average of 4 people per hour. The maintenance time follows an exponential distribution, taking an average of 6 minutes. This function is used to calculate the length of the queue (<span class="math inline">\(Ls\)</span>), the average length of stay (<span class="math inline">\(Ws\)</span>), and the probability of customer waiting (the probability of system busy) (<span class="math inline">\(Pwait\)</span>).</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" title="1"><span class="kw">library</span>(SC19003)</a></code></pre></div>
<pre><code>## 
## 载入程辑包：&#39;SC19003&#39;</code></pre>
<pre><code>## The following object is masked _by_ &#39;.GlobalEnv&#39;:
## 
##     queue1</code></pre>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" title="1">result1 &lt;-<span class="st"> </span><span class="kw">queue1</span>(<span class="dv">4</span>,<span class="dv">10</span>,<span class="dv">10000</span>) <span class="co"># we assume that queues are allowed forever so the parameter T is 10000 (a large number).</span></a>
<a class="sourceLine" id="cb5-2" title="2">result1</a></code></pre></div>
<pre><code>##         Ls        Ws     Pwait
## 1 0.668886 0.1672372 0.4013187</code></pre>
<p>The source R code for <em>queue2</em> is as follows:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" title="1">queue2&lt;-<span class="cf">function</span>(lambda, mu, T, S){</a>
<a class="sourceLine" id="cb7-2" title="2">  k&lt;-<span class="dv">0</span>; wt&lt;-<span class="dv">0</span>; wn&lt;-<span class="dv">0</span>; ws&lt;-<span class="dv">0</span></a>
<a class="sourceLine" id="cb7-3" title="3">  tp&lt;-<span class="dv">0</span>; nA&lt;-<span class="dv">0</span>; t&lt;-<span class="dv">0</span></a>
<a class="sourceLine" id="cb7-4" title="4">  r&lt;-<span class="kw">runif</span>(<span class="dv">1</span>); tA&lt;-<span class="op">-</span><span class="dv">1</span><span class="op">/</span>lambda<span class="op">*</span><span class="kw">log</span>(r)</a>
<a class="sourceLine" id="cb7-5" title="5">  tD&lt;-<span class="kw">rep</span>(<span class="ot">Inf</span>, S); SS&lt;-<span class="kw">rep</span>(<span class="dv">0</span>, S<span class="op">+</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb7-6" title="6">  <span class="cf">repeat</span>{</a>
<a class="sourceLine" id="cb7-7" title="7">    t1&lt;-<span class="cf">if</span>(SS[<span class="dv">1</span>]<span class="op">==</span><span class="dv">0</span>) <span class="ot">Inf</span> <span class="cf">else</span> <span class="kw">min</span>(tD)</a>
<a class="sourceLine" id="cb7-8" title="8">    i1&lt;-<span class="cf">if</span>(SS[<span class="dv">1</span>]<span class="op">==</span><span class="dv">0</span>) <span class="dv">1</span> <span class="cf">else</span> <span class="kw">which.min</span>(tD)</a>
<a class="sourceLine" id="cb7-9" title="9">    k&lt;-k<span class="op">+</span><span class="dv">1</span>; wt[k]&lt;-t; wn[k]&lt;-SS[<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb7-10" title="10">    <span class="cf">if</span> (tA <span class="op">&lt;</span><span class="st"> </span>T){</a>
<a class="sourceLine" id="cb7-11" title="11">      ws[k]&lt;-<span class="kw">min</span>(tA, t1)<span class="op">-</span>t</a>
<a class="sourceLine" id="cb7-12" title="12">      <span class="cf">if</span> (tA <span class="op">&lt;</span><span class="st"> </span>t1){</a>
<a class="sourceLine" id="cb7-13" title="13">        t&lt;-tA; nA&lt;-nA<span class="op">+</span><span class="dv">1</span></a>
<a class="sourceLine" id="cb7-14" title="14">        r&lt;-<span class="kw">runif</span>(<span class="dv">1</span>); tA&lt;-t<span class="dv">-1</span><span class="op">/</span>lambda<span class="op">*</span><span class="kw">log</span>(r)</a>
<a class="sourceLine" id="cb7-15" title="15">        n&lt;-SS[<span class="dv">1</span>]; SS[<span class="dv">1</span>]&lt;-n<span class="op">+</span><span class="dv">1</span></a>
<a class="sourceLine" id="cb7-16" title="16">        <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>S){</a>
<a class="sourceLine" id="cb7-17" title="17">          <span class="cf">if</span> (SS[<span class="dv">1</span><span class="op">+</span>i]<span class="op">==</span><span class="dv">0</span>){</a>
<a class="sourceLine" id="cb7-18" title="18">            SS[<span class="dv">1</span><span class="op">+</span>i]&lt;-<span class="dv">1</span></a>
<a class="sourceLine" id="cb7-19" title="19">            r&lt;-<span class="kw">runif</span>(<span class="dv">1</span>); tD[i]&lt;-t<span class="dv">-1</span><span class="op">/</span>mu<span class="op">*</span><span class="kw">log</span>(r)</a>
<a class="sourceLine" id="cb7-20" title="20">            <span class="cf">break</span></a>
<a class="sourceLine" id="cb7-21" title="21">          }</a>
<a class="sourceLine" id="cb7-22" title="22">        }</a>
<a class="sourceLine" id="cb7-23" title="23">        </a>
<a class="sourceLine" id="cb7-24" title="24">      }<span class="cf">else</span>{</a>
<a class="sourceLine" id="cb7-25" title="25">        t&lt;-t1; n&lt;-SS[<span class="dv">1</span>]; SS[<span class="dv">1</span>]&lt;-n<span class="dv">-1</span></a>
<a class="sourceLine" id="cb7-26" title="26">        <span class="cf">if</span> (n<span class="op">==</span><span class="dv">1</span>){</a>
<a class="sourceLine" id="cb7-27" title="27">          SS[<span class="dv">2</span><span class="op">:</span>(S<span class="op">+</span><span class="dv">1</span>)]&lt;-<span class="dv">0</span>; tD[<span class="dv">1</span><span class="op">:</span>S]&lt;-<span class="ot">Inf</span></a>
<a class="sourceLine" id="cb7-28" title="28">        }<span class="cf">else</span> <span class="cf">if</span> (n<span class="op">&lt;=</span>S){</a>
<a class="sourceLine" id="cb7-29" title="29">          SS[<span class="dv">1</span><span class="op">+</span>i1]&lt;-<span class="dv">0</span>; tD[i1]&lt;-<span class="ot">Inf</span></a>
<a class="sourceLine" id="cb7-30" title="30">        }<span class="cf">else</span>{</a>
<a class="sourceLine" id="cb7-31" title="31">          r&lt;-<span class="kw">runif</span>(<span class="dv">1</span>); tD[i1]&lt;-t<span class="dv">-1</span><span class="op">/</span>mu<span class="op">*</span><span class="kw">log</span>(r)</a>
<a class="sourceLine" id="cb7-32" title="32">        } }</a>
<a class="sourceLine" id="cb7-33" title="33">    }<span class="cf">else</span>{</a>
<a class="sourceLine" id="cb7-34" title="34">      ws[k]&lt;-<span class="st"> </span><span class="cf">if</span>( t1<span class="op">==</span><span class="ot">Inf</span>) <span class="dv">0</span> <span class="cf">else</span> t1<span class="op">-</span>t</a>
<a class="sourceLine" id="cb7-35" title="35">      n&lt;-SS[<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb7-36" title="36">      <span class="cf">if</span> (n<span class="op">&gt;</span><span class="dv">0</span>){</a>
<a class="sourceLine" id="cb7-37" title="37">        t&lt;-t1; SS[<span class="dv">1</span>]&lt;-n<span class="dv">-1</span>;</a>
<a class="sourceLine" id="cb7-38" title="38">        <span class="cf">if</span> (n<span class="op">==</span><span class="dv">1</span>){</a>
<a class="sourceLine" id="cb7-39" title="39">          SS[<span class="dv">2</span><span class="op">:</span>(S<span class="op">+</span><span class="dv">1</span>)]&lt;-<span class="dv">0</span>; tD[<span class="dv">1</span><span class="op">:</span>S]&lt;-<span class="ot">Inf</span></a>
<a class="sourceLine" id="cb7-40" title="40">        }<span class="cf">else</span> <span class="cf">if</span> (n<span class="op">&lt;=</span>S){</a>
<a class="sourceLine" id="cb7-41" title="41">          SS[<span class="dv">1</span><span class="op">+</span>i1]&lt;-<span class="dv">0</span>; tD[i1]&lt;-<span class="ot">Inf</span></a>
<a class="sourceLine" id="cb7-42" title="42">        }<span class="cf">else</span>{</a>
<a class="sourceLine" id="cb7-43" title="43">          r&lt;-<span class="kw">runif</span>(<span class="dv">1</span>); tD[i1]&lt;-t<span class="dv">-1</span><span class="op">/</span>mu<span class="op">*</span><span class="kw">log</span>(r)</a>
<a class="sourceLine" id="cb7-44" title="44">        }</a>
<a class="sourceLine" id="cb7-45" title="45">      }<span class="cf">else</span></a>
<a class="sourceLine" id="cb7-46" title="46">        tp&lt;-<span class="dv">1</span></a>
<a class="sourceLine" id="cb7-47" title="47">    }</a>
<a class="sourceLine" id="cb7-48" title="48">    <span class="cf">if</span> (tp<span class="op">==</span><span class="dv">1</span>) <span class="cf">break</span></a>
<a class="sourceLine" id="cb7-49" title="49">  }</a>
<a class="sourceLine" id="cb7-50" title="50">  <span class="kw">data.frame</span>(<span class="dt">Ls=</span><span class="kw">sum</span>(ws<span class="op">*</span>wn)<span class="op">/</span>t, <span class="dt">Ws=</span><span class="kw">sum</span>(ws<span class="op">*</span>wn)<span class="op">/</span>nA,</a>
<a class="sourceLine" id="cb7-51" title="51">             <span class="dt">Pwait=</span><span class="kw">sum</span>(ws[wn<span class="op">&gt;=</span>S])<span class="op">/</span>t)</a>
<a class="sourceLine" id="cb7-52" title="52">}</a></code></pre></div>
<p>Suppose there are three typists in the printing room, the average printing time of each document is 10 minutes, and the reaching rate of documents is 15 pieces per hour. Use the function to calculate the length of the file queue (<span class="math inline">\(Ls\)</span>), the average staying time (<span class="math inline">\(Ws\)</span>) and the probability of waiting (<span class="math inline">\(Pwait\)</span>).</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" title="1"><span class="kw">library</span>(SC19003)</a>
<a class="sourceLine" id="cb8-2" title="2">result2 &lt;-<span class="st"> </span><span class="kw">queue2</span>(<span class="dv">15</span>,<span class="dv">6</span>,<span class="dv">1000</span>,<span class="dv">3</span>) <span class="co"># we assume that queues are allowed forever so the parameter T is 1000 (a large number).</span></a>
<a class="sourceLine" id="cb8-3" title="3">result2</a></code></pre></div>
<pre><code>##         Ls        Ws     Pwait
## 1 5.592291 0.3741514 0.6831078</code></pre>
</div>
<div id="homework-1" class="section level1">
<h1>Homework 1</h1>
<div id="question" class="section level2">
<h2>Question</h2>
<p>Use knitr to produce at least 3 examples(texts,figures,tables).</p>
</div>
<div id="answer" class="section level2">
<h2>Answer</h2>
</div>
<div id="text" class="section level2">
<h2>text</h2>
<p>This is the first assignment for this class and I hope the study of this course can go well in the future.</p>
</div>
<div id="figures-tables" class="section level2">
<h2>figures &amp; tables</h2>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" title="1">age &lt;-<span class="kw">c</span>(<span class="dv">21</span>,<span class="dv">30</span>,<span class="dv">35</span>,<span class="dv">44</span>,<span class="dv">45</span>,<span class="dv">33</span>,<span class="dv">25</span>,<span class="dv">27</span>,<span class="dv">29</span>,<span class="dv">48</span>)</a>
<a class="sourceLine" id="cb10-2" title="2">height &lt;-<span class="kw">c</span>(<span class="dv">160</span>,<span class="dv">162</span>,<span class="dv">165</span>,<span class="dv">158</span>,<span class="dv">155</span>,<span class="dv">164</span>,<span class="dv">162</span>,<span class="dv">150</span>,<span class="dv">167</span>,<span class="dv">161</span>)</a>
<a class="sourceLine" id="cb10-3" title="3">group &lt;-<span class="kw">gl</span>(<span class="dv">2</span>,<span class="dv">10</span>,<span class="dv">20</span>,<span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;age&quot;</span>,<span class="st">&quot;height&quot;</span>))</a>
<a class="sourceLine" id="cb10-4" title="4">weight &lt;-<span class="kw">c</span>(age,height)</a>
<a class="sourceLine" id="cb10-5" title="5">lm.D9 &lt;-<span class="kw">lm</span>(weight<span class="op">~</span>group)</a>
<a class="sourceLine" id="cb10-6" title="6"><span class="kw">summary</span>(lm.D9)<span class="op">$</span>coef</a></code></pre></div>
<pre><code>##             Estimate Std. Error  t value     Pr(&gt;|t|)
## (Intercept)     33.7   2.338684 14.40981 2.518398e-11
## groupheight    126.7   3.307399 38.30805 1.050118e-18</code></pre>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" title="1">knitr<span class="op">::</span><span class="kw">kable</span>(<span class="kw">head</span>(USJudgeRatings))</a></code></pre></div>
<table>
<thead>
<tr class="header">
<th></th>
<th align="right">CONT</th>
<th align="right">INTG</th>
<th align="right">DMNR</th>
<th align="right">DILG</th>
<th align="right">CFMG</th>
<th align="right">DECI</th>
<th align="right">PREP</th>
<th align="right">FAMI</th>
<th align="right">ORAL</th>
<th align="right">WRIT</th>
<th align="right">PHYS</th>
<th align="right">RTEN</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>AARONSON,L.H.</td>
<td align="right">5.7</td>
<td align="right">7.9</td>
<td align="right">7.7</td>
<td align="right">7.3</td>
<td align="right">7.1</td>
<td align="right">7.4</td>
<td align="right">7.1</td>
<td align="right">7.1</td>
<td align="right">7.1</td>
<td align="right">7.0</td>
<td align="right">8.3</td>
<td align="right">7.8</td>
</tr>
<tr class="even">
<td>ALEXANDER,J.M.</td>
<td align="right">6.8</td>
<td align="right">8.9</td>
<td align="right">8.8</td>
<td align="right">8.5</td>
<td align="right">7.8</td>
<td align="right">8.1</td>
<td align="right">8.0</td>
<td align="right">8.0</td>
<td align="right">7.8</td>
<td align="right">7.9</td>
<td align="right">8.5</td>
<td align="right">8.7</td>
</tr>
<tr class="odd">
<td>ARMENTANO,A.J.</td>
<td align="right">7.2</td>
<td align="right">8.1</td>
<td align="right">7.8</td>
<td align="right">7.8</td>
<td align="right">7.5</td>
<td align="right">7.6</td>
<td align="right">7.5</td>
<td align="right">7.5</td>
<td align="right">7.3</td>
<td align="right">7.4</td>
<td align="right">7.9</td>
<td align="right">7.8</td>
</tr>
<tr class="even">
<td>BERDON,R.I.</td>
<td align="right">6.8</td>
<td align="right">8.8</td>
<td align="right">8.5</td>
<td align="right">8.8</td>
<td align="right">8.3</td>
<td align="right">8.5</td>
<td align="right">8.7</td>
<td align="right">8.7</td>
<td align="right">8.4</td>
<td align="right">8.5</td>
<td align="right">8.8</td>
<td align="right">8.7</td>
</tr>
<tr class="odd">
<td>BRACKEN,J.J.</td>
<td align="right">7.3</td>
<td align="right">6.4</td>
<td align="right">4.3</td>
<td align="right">6.5</td>
<td align="right">6.0</td>
<td align="right">6.2</td>
<td align="right">5.7</td>
<td align="right">5.7</td>
<td align="right">5.1</td>
<td align="right">5.3</td>
<td align="right">5.5</td>
<td align="right">4.8</td>
</tr>
<tr class="even">
<td>BURNS,E.B.</td>
<td align="right">6.2</td>
<td align="right">8.8</td>
<td align="right">8.7</td>
<td align="right">8.5</td>
<td align="right">7.9</td>
<td align="right">8.0</td>
<td align="right">8.1</td>
<td align="right">8.0</td>
<td align="right">8.0</td>
<td align="right">8.0</td>
<td align="right">8.6</td>
<td align="right">8.6</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" title="1"><span class="kw">par</span>(<span class="dt">mar=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>))</a>
<a class="sourceLine" id="cb13-2" title="2"><span class="kw">plot</span>(lm.D9)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
<div id="homework-2" class="section level1">
<h1>Homework 2</h1>
<div id="question-3.4" class="section level2">
<h2>Question 3.4</h2>
<p>The Rayleigh density [156, Ch. 18] is</p>
<p><span class="math inline">\(f(x)=\frac{x}{\sigma^{2}} e^{-x^{2} /\left(2 \sigma^{2}\right)}, \quad x \geq 0, \sigma&gt;0\)</span></p>
<p>Develop an algorithm to generate random samples from a Rayleigh(σ) distribution. Generate Rayleigh(σ) samples for several choices of σ &gt; 0 and check that the mode of the generated samples is close to the theoretical mode σ (check the histogram).</p>
</div>
<div id="answer-1" class="section level2">
<h2>Answer</h2>
<div id="sigma-1" class="section level3">
<h3>sigma = 1</h3>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" title="1">n&lt;-<span class="dv">1000</span></a>
<a class="sourceLine" id="cb14-2" title="2">u&lt;-<span class="kw">runif</span>(n)</a>
<a class="sourceLine" id="cb14-3" title="3">sigma&lt;-<span class="dv">1</span></a>
<a class="sourceLine" id="cb14-4" title="4">x&lt;-(<span class="op">-</span><span class="dv">2</span><span class="op">*</span>(sigma<span class="op">^</span><span class="dv">2</span>)<span class="op">*</span><span class="kw">log</span>(u))<span class="op">^</span>(<span class="dv">1</span><span class="op">/</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb14-5" title="5"><span class="kw">hist</span>(x,<span class="dt">probability =</span> T,<span class="dt">main =</span> <span class="kw">expression</span>(<span class="kw">f</span>(x)<span class="op">==</span>(x<span class="op">/</span>(sigma<span class="op">^</span><span class="dv">2</span>))<span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span>(x<span class="op">^</span><span class="dv">2</span>)<span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>(sigma<span class="op">^</span><span class="dv">2</span>)))))</a>
<a class="sourceLine" id="cb14-6" title="6">y &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">4</span>,<span class="fl">0.01</span>) </a>
<a class="sourceLine" id="cb14-7" title="7"><span class="kw">lines</span>(y,y<span class="op">/</span>(sigma<span class="op">^</span><span class="dv">2</span>)<span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span>(y<span class="op">^</span><span class="dv">2</span>)<span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>(sigma<span class="op">^</span><span class="dv">2</span>))))</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="sigma-2" class="section level3">
<h3>sigma = 2</h3>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" title="1">sigma&lt;-<span class="dv">2</span></a>
<a class="sourceLine" id="cb15-2" title="2">x&lt;-(<span class="op">-</span><span class="dv">2</span><span class="op">*</span>(sigma<span class="op">^</span><span class="dv">2</span>)<span class="op">*</span><span class="kw">log</span>(u))<span class="op">^</span>(<span class="dv">1</span><span class="op">/</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb15-3" title="3"><span class="kw">hist</span>(x,<span class="dt">probability =</span> T,<span class="dt">main =</span> <span class="kw">expression</span>(<span class="kw">f</span>(x)<span class="op">==</span>(x<span class="op">/</span>(sigma<span class="op">^</span><span class="dv">2</span>))<span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span>(x<span class="op">^</span><span class="dv">2</span>)<span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>(sigma<span class="op">^</span><span class="dv">2</span>)))))</a>
<a class="sourceLine" id="cb15-4" title="4">y &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">8</span>,<span class="fl">0.01</span>) </a>
<a class="sourceLine" id="cb15-5" title="5"><span class="kw">lines</span>(y,y<span class="op">/</span>(sigma<span class="op">^</span><span class="dv">2</span>)<span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span>(y<span class="op">^</span><span class="dv">2</span>)<span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>(sigma<span class="op">^</span><span class="dv">2</span>))))</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="sigma-4" class="section level3">
<h3>sigma = 4</h3>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" title="1">sigma&lt;-<span class="dv">4</span></a>
<a class="sourceLine" id="cb16-2" title="2">x&lt;-(<span class="op">-</span><span class="dv">2</span><span class="op">*</span>(sigma<span class="op">^</span><span class="dv">2</span>)<span class="op">*</span><span class="kw">log</span>(u))<span class="op">^</span>(<span class="dv">1</span><span class="op">/</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb16-3" title="3"><span class="kw">hist</span>(x,<span class="dt">probability =</span> T,<span class="dt">main =</span> <span class="kw">expression</span>(<span class="kw">f</span>(x)<span class="op">==</span>(x<span class="op">/</span>(sigma<span class="op">^</span><span class="dv">2</span>))<span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span>(x<span class="op">^</span><span class="dv">2</span>)<span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>(sigma<span class="op">^</span><span class="dv">2</span>)))))</a>
<a class="sourceLine" id="cb16-4" title="4">y &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">15</span>,<span class="fl">0.01</span>) </a>
<a class="sourceLine" id="cb16-5" title="5"><span class="kw">lines</span>(y,y<span class="op">/</span>(sigma<span class="op">^</span><span class="dv">2</span>)<span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span>(y<span class="op">^</span><span class="dv">2</span>)<span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>(sigma<span class="op">^</span><span class="dv">2</span>))))</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
<div id="question-3.11" class="section level2">
<h2>Question 3.11</h2>
<p>Generate a random sample of size 1000 from a normal location mixture. The components of the mixture have N(0, 1) and N(3, 1) distributions with mixing probabilities p1 and p2 = 1 − p1. Graph the histogram of the sample with density superimposed, for p1 = 0.75. Repeat with different values for p1and observe whether the empirical distribution of the mixture appears to be bimodal. Make a conjecture about the values of p1 that produce bimodal mixtures.</p>
</div>
<div id="answer-2" class="section level2">
<h2>Answer</h2>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" title="1"><span class="kw">library</span>(MASS)</a>
<a class="sourceLine" id="cb17-2" title="2">n&lt;-<span class="dv">1000</span></a>
<a class="sourceLine" id="cb17-3" title="3">x1&lt;-<span class="kw">rnorm</span>(n,<span class="dv">0</span>,<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb17-4" title="4">x2&lt;-<span class="kw">rnorm</span>(n,<span class="dv">3</span>,<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb17-5" title="5">p &lt;-<span class="st"> </span><span class="fl">0.75</span></a>
<a class="sourceLine" id="cb17-6" title="6">r&lt;-<span class="kw">sample</span>(<span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),n,<span class="dt">replace =</span> <span class="ot">TRUE</span>,<span class="dt">prob =</span> <span class="kw">c</span>(p,<span class="dv">1</span><span class="op">-</span>p))</a>
<a class="sourceLine" id="cb17-7" title="7">z&lt;-(<span class="dv">1</span><span class="op">-</span>r)<span class="op">*</span>x1<span class="op">+</span>r<span class="op">*</span>x2</a>
<a class="sourceLine" id="cb17-8" title="8"><span class="kw">hist</span>(z)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" title="1">p &lt;-<span class="st"> </span><span class="fl">0.5</span></a>
<a class="sourceLine" id="cb18-2" title="2">r&lt;-<span class="kw">sample</span>(<span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),n,<span class="dt">replace =</span> <span class="ot">TRUE</span>,<span class="dt">prob =</span> <span class="kw">c</span>(p,<span class="dv">1</span><span class="op">-</span>p))</a>
<a class="sourceLine" id="cb18-3" title="3">z&lt;-(<span class="dv">1</span><span class="op">-</span>r)<span class="op">*</span>x1<span class="op">+</span>r<span class="op">*</span>x2</a>
<a class="sourceLine" id="cb18-4" title="4"><span class="kw">hist</span>(z)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="question-3.18" class="section level2">
<h2>Question 3.18</h2>
<p>Write a function to generate a random sample from a Wd(Σ, n) (Wishart) distribution for n &gt; d + 1 ≥ 1, based on Bartlett’s decomposition.</p>
</div>
<div id="answer-3" class="section level2">
<h2>Answer</h2>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" title="1">n &lt;-<span class="st"> </span><span class="dv">10</span></a>
<a class="sourceLine" id="cb19-2" title="2">sigma_<span class="dv">1</span> &lt;-<span class="dv">4</span> <span class="op">*</span><span class="st"> </span><span class="kw">diag</span>(<span class="dv">4</span>)</a>
<a class="sourceLine" id="cb19-3" title="3">Wd&lt;-<span class="cf">function</span>(sigma_<span class="dv">1</span>,n){</a>
<a class="sourceLine" id="cb19-4" title="4">  p&lt;-<span class="kw">nrow</span>(sigma_<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb19-5" title="5">  l&lt;-<span class="kw">chol</span>(sigma_<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb19-6" title="6">  A&lt;-<span class="kw">matrix</span>(<span class="dt">nrow =</span> p,<span class="dt">ncol =</span> p)</a>
<a class="sourceLine" id="cb19-7" title="7">  A[<span class="kw">upper.tri</span>(A)]&lt;-<span class="dv">0</span></a>
<a class="sourceLine" id="cb19-8" title="8">  c&lt;-<span class="kw">numeric</span>(p)</a>
<a class="sourceLine" id="cb19-9" title="9">  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>p){</a>
<a class="sourceLine" id="cb19-10" title="10">    c[i]&lt;-<span class="kw">rchisq</span>(<span class="dv">1</span>,n<span class="op">-</span>i<span class="op">+</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb19-11" title="11">  }</a>
<a class="sourceLine" id="cb19-12" title="12">  <span class="kw">diag</span>(A)&lt;-c</a>
<a class="sourceLine" id="cb19-13" title="13">  A[<span class="kw">lower.tri</span>(A)]&lt;-<span class="kw">rnorm</span>((p<span class="op">^</span><span class="dv">2</span><span class="op">-</span>p)<span class="op">/</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb19-14" title="14">  s&lt;-l<span class="op">%*%</span>A<span class="op">%*%</span><span class="kw">t</span>(A)<span class="op">%*%</span><span class="kw">t</span>(l)</a>
<a class="sourceLine" id="cb19-15" title="15">  <span class="kw">return</span>(s)</a>
<a class="sourceLine" id="cb19-16" title="16">}</a>
<a class="sourceLine" id="cb19-17" title="17"><span class="kw">Wd</span>(sigma_<span class="dv">1</span>,n)</a></code></pre></div>
<pre><code>##           [,1]       [,2]       [,3]      [,4]
## [1,] 726.82682  40.129371 -18.935432 -23.94655
## [2,]  40.12937 641.648847  -6.062769 -91.67006
## [3,] -18.93543  -6.062769 104.541979 -14.19503
## [4,] -23.94655 -91.670062 -14.195030 127.65444</code></pre>
</div>
</div>
<div id="homework-3" class="section level1">
<h1>Homework 3</h1>
<div id="question-5.1" class="section level2">
<h2>Question 5.1</h2>
<p>Compute a Monte Carlo estimate of</p>
<p><span class="math inline">\(\int_{0}^{\pi / 3} \sin t d t\)</span></p>
<p>and compare your estimate with the exact value of the integral.</p>
</div>
<div id="answer-4" class="section level2">
<h2>Answer</h2>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb21-1" title="1"><span class="kw">set.seed</span>(<span class="dv">123</span>)</a>
<a class="sourceLine" id="cb21-2" title="2">m&lt;-<span class="dv">10000</span></a>
<a class="sourceLine" id="cb21-3" title="3">x&lt;-<span class="kw">runif</span>(m,<span class="dt">min =</span> <span class="dv">0</span>,<span class="dt">max =</span> pi<span class="op">/</span><span class="dv">3</span>)</a>
<a class="sourceLine" id="cb21-4" title="4">theta.hat&lt;-<span class="kw">mean</span>(<span class="kw">sin</span>(x))<span class="op">*</span>(pi<span class="op">/</span><span class="dv">3</span>)</a>
<a class="sourceLine" id="cb21-5" title="5"><span class="kw">print</span>(<span class="kw">c</span>(theta.hat,<span class="kw">cos</span>(<span class="dv">0</span>)<span class="op">-</span><span class="kw">cos</span>(pi<span class="op">/</span><span class="dv">3</span>)))</a></code></pre></div>
<pre><code>## [1] 0.49808 0.50000</code></pre>
</div>
<div id="question-5.10" class="section level2">
<h2>Question 5.10</h2>
<p>Use Monte Carlo integration with antithetic variables to estimate</p>
<p><span class="math inline">\(\int_{0}^{1} \frac{e^{-x}}{1+x^{2}} d x\)</span></p>
<p>and find the approximate reduction in variance as a percentage of the variance without variance reduction.</p>
</div>
<div id="answer-5" class="section level2">
<h2>Answer</h2>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb23-1" title="1"><span class="kw">set.seed</span>(<span class="dv">12345</span>)</a>
<a class="sourceLine" id="cb23-2" title="2">n&lt;-<span class="dv">10000</span></a>
<a class="sourceLine" id="cb23-3" title="3">u&lt;-<span class="kw">runif</span>(n)</a>
<a class="sourceLine" id="cb23-4" title="4">y1&lt;-<span class="kw">exp</span>(<span class="op">-</span>u)<span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>u<span class="op">^</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb23-5" title="5">y2&lt;-<span class="kw">exp</span>(u<span class="dv">-1</span>)<span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>(<span class="dv">1</span><span class="op">-</span>u)<span class="op">^</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb23-6" title="6">y0&lt;-<span class="kw">c</span>(y1,y2)</a>
<a class="sourceLine" id="cb23-7" title="7">Use&lt;-<span class="kw">mean</span>(y0)</a>
<a class="sourceLine" id="cb23-8" title="8">Use</a></code></pre></div>
<pre><code>## [1] 0.5243804</code></pre>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb25-1" title="1">var0&lt;-(<span class="dv">1</span><span class="op">/</span><span class="dv">4</span>)<span class="op">*</span><span class="kw">var</span>(y1)<span class="op">+</span>(<span class="dv">1</span><span class="op">/</span><span class="dv">4</span>)<span class="op">*</span><span class="kw">var</span>(y2)<span class="op">+</span>(<span class="dv">1</span><span class="op">/</span><span class="dv">2</span>)<span class="op">*</span><span class="kw">cov</span>(y1,y2)</a>
<a class="sourceLine" id="cb25-2" title="2">var0</a></code></pre></div>
<pre><code>## [1] 0.00108792</code></pre>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb27-1" title="1"><span class="kw">set.seed</span>(<span class="dv">12345</span>)</a>
<a class="sourceLine" id="cb27-2" title="2">n&lt;-<span class="dv">10000</span></a>
<a class="sourceLine" id="cb27-3" title="3">u&lt;-<span class="kw">runif</span>(n)</a>
<a class="sourceLine" id="cb27-4" title="4">y&lt;-<span class="kw">exp</span>(<span class="op">-</span>u)<span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>u<span class="op">^</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb27-5" title="5">Ise&lt;-<span class="kw">mean</span>(y)</a>
<a class="sourceLine" id="cb27-6" title="6">Ise</a></code></pre></div>
<pre><code>## [1] 0.5237823</code></pre>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb29-1" title="1"><span class="kw">var</span>(y)</a></code></pre></div>
<pre><code>## [1] 0.05942649</code></pre>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb31-1" title="1">(<span class="kw">var</span>(y)<span class="op">-</span>var0)<span class="op">/</span>(<span class="kw">var</span>(y))</a></code></pre></div>
<pre><code>## [1] 0.981693</code></pre>
</div>
<div id="question-5.15" class="section level2">
<h2>Question 5.15</h2>
<p>Obtain the stratified importance sampling estimate in Example 5.13 and compare it with the result of Example 5.10.</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb33-1" title="1"><span class="kw">set.seed</span>(<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb33-2" title="2">m&lt;-<span class="kw">numeric</span>(<span class="dv">6</span>)</a>
<a class="sourceLine" id="cb33-3" title="3">a&lt;-<span class="kw">c</span>(<span class="dv">0</span>,<span class="fl">0.2</span>,<span class="fl">0.4</span>,<span class="fl">0.6</span>,<span class="fl">0.8</span>,<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb33-4" title="4"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">6</span>){</a>
<a class="sourceLine" id="cb33-5" title="5">  m[i]&lt;-<span class="op">-</span><span class="kw">log</span>(<span class="dv">1</span><span class="op">-</span>a[i]<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span><span class="kw">exp</span>(<span class="op">-</span><span class="dv">1</span>)))</a>
<a class="sourceLine" id="cb33-6" title="6">}</a>
<a class="sourceLine" id="cb33-7" title="7"><span class="kw">print</span>(m)</a></code></pre></div>
<pre><code>## [1] 0.0000000 0.1351603 0.2914869 0.4768628 0.7046055 1.0000000</code></pre>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb35-1" title="1"><span class="co">## stratified importance sampling estimate</span></a>
<a class="sourceLine" id="cb35-2" title="2">M &lt;-<span class="st"> </span><span class="dv">10000</span> </a>
<a class="sourceLine" id="cb35-3" title="3">k &lt;-<span class="st"> </span><span class="dv">5</span> </a>
<a class="sourceLine" id="cb35-4" title="4">r &lt;-<span class="st"> </span>M <span class="op">/</span><span class="st"> </span>k </a>
<a class="sourceLine" id="cb35-5" title="5">N &lt;-<span class="st"> </span><span class="dv">50</span> </a>
<a class="sourceLine" id="cb35-6" title="6">T2 &lt;-<span class="st"> </span><span class="kw">numeric</span>(k)</a>
<a class="sourceLine" id="cb35-7" title="7">estimates &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>, N, <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb35-8" title="8">g&lt;-<span class="cf">function</span>(x) {</a>
<a class="sourceLine" id="cb35-9" title="9">  <span class="kw">exp</span>(<span class="op">-</span>x)<span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>x<span class="op">^</span><span class="dv">2</span>)<span class="op">*</span>(x<span class="op">&gt;</span><span class="dv">0</span>)<span class="op">*</span>(x<span class="op">&lt;</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb35-10" title="10">}</a>
<a class="sourceLine" id="cb35-11" title="11"></a>
<a class="sourceLine" id="cb35-12" title="12"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N) {</a>
<a class="sourceLine" id="cb35-13" title="13">  u&lt;-<span class="kw">runif</span>(m)</a>
<a class="sourceLine" id="cb35-14" title="14">  x&lt;-<span class="op">-</span><span class="kw">log</span>(<span class="dv">1</span><span class="op">-</span>u<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span><span class="kw">exp</span>(<span class="op">-</span><span class="dv">1</span>)))    <span class="co"># inverse transformated method</span></a>
<a class="sourceLine" id="cb35-15" title="15">  g1&lt;-<span class="kw">g</span>(x)<span class="op">/</span>(<span class="kw">exp</span>(<span class="op">-</span>x)<span class="op">/</span>(<span class="dv">1</span><span class="op">-</span><span class="kw">exp</span>(<span class="op">-</span><span class="dv">1</span>)))</a>
<a class="sourceLine" id="cb35-16" title="16">  estimates[i,<span class="dv">1</span>]&lt;-<span class="kw">mean</span>(g1)</a>
<a class="sourceLine" id="cb35-17" title="17">  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>k) {</a>
<a class="sourceLine" id="cb35-18" title="18">    v&lt;-<span class="kw">runif</span>(m<span class="op">/</span><span class="dv">5</span>)</a>
<a class="sourceLine" id="cb35-19" title="19">    y&lt;-<span class="op">-</span><span class="kw">log</span>(<span class="kw">exp</span>(<span class="op">-</span>m[j])<span class="op">-</span>v<span class="op">/</span><span class="dv">5</span><span class="op">*</span>(<span class="dv">1</span><span class="op">-</span><span class="kw">exp</span>(<span class="op">-</span><span class="dv">1</span>)))</a>
<a class="sourceLine" id="cb35-20" title="20">    g2&lt;-<span class="kw">g</span>(y)<span class="op">/</span>(<span class="dv">5</span><span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span>y)<span class="op">/</span>(<span class="dv">1</span><span class="op">-</span><span class="kw">exp</span>(<span class="op">-</span><span class="dv">1</span>)))</a>
<a class="sourceLine" id="cb35-21" title="21">    T2[j]&lt;-<span class="kw">mean</span>(g2)</a>
<a class="sourceLine" id="cb35-22" title="22">  }</a>
<a class="sourceLine" id="cb35-23" title="23">estimates[i,<span class="dv">2</span>]&lt;-<span class="kw">sum</span>(T2)</a>
<a class="sourceLine" id="cb35-24" title="24">}</a>
<a class="sourceLine" id="cb35-25" title="25"><span class="kw">print</span>(estimates)</a></code></pre></div>
<pre><code>##            [,1]      [,2]
##  [1,] 0.5141923 0.5254007
##  [2,] 0.4985529 0.5270709
##  [3,] 0.4866306 0.5252333
##  [4,] 0.4684848 0.5242017
##  [5,] 0.5565671 0.5210239
##  [6,] 0.4846112 0.5241266
##  [7,] 0.4982429 0.5261936
##  [8,] 0.5381037 0.5347022
##  [9,] 0.5736298 0.5261270
## [10,] 0.4186641 0.5246105
## [11,] 0.5536839 0.5247749
## [12,] 0.5664161 0.5186065
## [13,] 0.5434959 0.5278178
## [14,] 0.5052709 0.5263202
## [15,] 0.4675082 0.5276484
## [16,] 0.5237280 0.5246077
## [17,] 0.5098837 0.5170573
## [18,] 0.5577318 0.5265179
## [19,] 0.4484199 0.5255487
## [20,] 0.5678925 0.5235883
## [21,] 0.5052991 0.5281012
## [22,] 0.5253645 0.5232413
## [23,] 0.5400960 0.5223195
## [24,] 0.4813796 0.5295451
## [25,] 0.5606899 0.5310887
## [26,] 0.5533063 0.5211123
## [27,] 0.4964296 0.5228675
## [28,] 0.5559665 0.5290745
## [29,] 0.4904059 0.5266985
## [30,] 0.5731640 0.5249295
## [31,] 0.5631445 0.5260084
## [32,] 0.5459262 0.5276367
## [33,] 0.5093494 0.5286459
## [34,] 0.5294193 0.5247947
## [35,] 0.5297244 0.5244211
## [36,] 0.5642969 0.5241283
## [37,] 0.5749023 0.5291729
## [38,] 0.5107380 0.5303655
## [39,] 0.5980139 0.5215201
## [40,] 0.5636145 0.5213576
## [41,] 0.5154384 0.5295150
## [42,] 0.5164041 0.5257703
## [43,] 0.4390717 0.5239932
## [44,] 0.5426427 0.5174693
## [45,] 0.5047352 0.5284369
## [46,] 0.4871931 0.5271887
## [47,] 0.5627235 0.5180063
## [48,] 0.5517938 0.5295189
## [49,] 0.4671064 0.5258882
## [50,] 0.5059023 0.5292530</code></pre>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb37-1" title="1"><span class="kw">apply</span>(estimates, <span class="dv">2</span>, mean)</a></code></pre></div>
<pre><code>## [1] 0.5229190 0.5254649</code></pre>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb39-1" title="1"><span class="kw">apply</span>(estimates, <span class="dv">2</span>, var)</a></code></pre></div>
<pre><code>## [1] 1.565651e-03 1.280849e-05</code></pre>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb41-1" title="1"><span class="kw">print</span>((<span class="kw">var</span>(estimates[,<span class="dv">1</span>])<span class="op">-</span><span class="kw">var</span>(estimates[,<span class="dv">2</span>]))<span class="op">/</span><span class="kw">var</span>(estimates[,<span class="dv">1</span>]))</a></code></pre></div>
<pre><code>## [1] 0.9918191</code></pre>
</div>
</div>
<div id="homework-4" class="section level1">
<h1>Homework 4</h1>
<div id="question-6.5" class="section level2">
<h2>Question 6.5</h2>
<p>Suppose a 95% symmetric t-interval is applied to estimate a mean, but the sample data are non-normal. Then the probability that the confidence interval covers the mean is not necessarily equal to 0.95. Use a Monte Carlo experiment to estimate the coverage probability of the t-interval for random samples of <span class="math inline">\(\chi^{2}(2)\)</span> data with sample size n = 20. Compare your t-interval results with the simulation results in Example 6.4. (The t-interval should be more robust to departures from normality than the interval for variance.)</p>
</div>
<div id="answer-6" class="section level2">
<h2>Answer</h2>
<div id="the-coverage-probability-of-the-t-interval" class="section level3">
<h3>The coverage probability of the t-interval</h3>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb43-1" title="1">n &lt;-<span class="st"> </span><span class="dv">20</span></a>
<a class="sourceLine" id="cb43-2" title="2"><span class="kw">set.seed</span>(<span class="dv">012345678</span>)</a>
<a class="sourceLine" id="cb43-3" title="3">alpha &lt;-<span class="st"> </span><span class="fl">0.05</span></a>
<a class="sourceLine" id="cb43-4" title="4">CL&lt;-<span class="kw">replicate</span>(<span class="dv">1000</span>,<span class="dt">expr=</span>{</a>
<a class="sourceLine" id="cb43-5" title="5">  x &lt;-<span class="st"> </span><span class="kw">rchisq</span>(n, <span class="dt">df =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb43-6" title="6">  UCL&lt;-<span class="kw">mean</span>(x) <span class="op">+</span><span class="kw">qt</span>(<span class="dv">1</span><span class="op">-</span>alpha<span class="op">/</span><span class="dv">2</span>, <span class="dt">df =</span> n<span class="dv">-1</span>)<span class="op">*</span><span class="kw">sd</span>(x)<span class="op">/</span><span class="kw">sqrt</span>(n)</a>
<a class="sourceLine" id="cb43-7" title="7">  LCL&lt;-<span class="kw">mean</span>(x) <span class="op">-</span><span class="st"> </span><span class="kw">qt</span>(<span class="dv">1</span><span class="op">-</span>alpha<span class="op">/</span><span class="dv">2</span>, <span class="dt">df =</span> n<span class="dv">-1</span>)<span class="op">*</span><span class="kw">sd</span>(x)<span class="op">/</span><span class="kw">sqrt</span>(n)</a>
<a class="sourceLine" id="cb43-8" title="8">  <span class="kw">c</span>(LCL,UCL)</a>
<a class="sourceLine" id="cb43-9" title="9">})</a>
<a class="sourceLine" id="cb43-10" title="10">cum&lt;-<span class="dv">0</span></a>
<a class="sourceLine" id="cb43-11" title="11">a&lt;-<span class="dv">2</span></a>
<a class="sourceLine" id="cb43-12" title="12"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">1000</span>){</a>
<a class="sourceLine" id="cb43-13" title="13">  <span class="cf">if</span>(CL[<span class="dv">1</span>,i]<span class="op">&lt;</span>a <span class="op">&amp;&amp;</span><span class="st"> </span>a <span class="op">&lt;</span><span class="st"> </span>CL[<span class="dv">2</span>,i] )</a>
<a class="sourceLine" id="cb43-14" title="14">  cum &lt;-<span class="st"> </span>cum <span class="op">+</span><span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb43-15" title="15">  }</a>
<a class="sourceLine" id="cb43-16" title="16">cp&lt;-<span class="st"> </span>cum<span class="op">/</span><span class="dv">1000</span></a>
<a class="sourceLine" id="cb43-17" title="17"><span class="kw">print</span>(cp)</a></code></pre></div>
<pre><code>## [1] 0.912</code></pre>
</div>
<div id="compare-the-t-interval-results-with-the-simulation-results-in-example-6.4" class="section level3">
<h3>Compare the t-interval results with the simulation results in Example 6.4</h3>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb45-1" title="1"><span class="kw">set.seed</span>(<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb45-2" title="2">n &lt;-<span class="st"> </span><span class="dv">20</span></a>
<a class="sourceLine" id="cb45-3" title="3">alpha &lt;-<span class="st"> </span><span class="fl">.05</span></a>
<a class="sourceLine" id="cb45-4" title="4">UCL &lt;-<span class="st"> </span><span class="kw">replicate</span>(<span class="dv">1000</span>, <span class="dt">expr =</span> {</a>
<a class="sourceLine" id="cb45-5" title="5">x &lt;-<span class="st"> </span><span class="kw">rchisq</span>(n, <span class="dt">df =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb45-6" title="6">(n<span class="dv">-1</span>) <span class="op">*</span><span class="st"> </span><span class="kw">var</span>(x) <span class="op">/</span><span class="st"> </span><span class="kw">qchisq</span>(alpha, <span class="dt">df =</span> n<span class="dv">-1</span>)</a>
<a class="sourceLine" id="cb45-7" title="7">} )</a>
<a class="sourceLine" id="cb45-8" title="8"><span class="kw">sum</span>(UCL <span class="op">&gt;</span><span class="st"> </span><span class="dv">4</span>)</a></code></pre></div>
<pre><code>## [1] 797</code></pre>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb47-1" title="1"><span class="kw">mean</span>(UCL <span class="op">&gt;</span><span class="dv">4</span>)</a></code></pre></div>
<pre><code>## [1] 0.797</code></pre>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb49-1" title="1"><span class="co">## The t-interval should be more robust to departures from normality than the interval for variance.In this experiment, only 797 or 79.7% of the intervals contained the population variance.</span></a></code></pre></div>
</div>
</div>
<div id="question-6.6" class="section level2">
<h2>Question 6.6</h2>
<p>Estimate the 0.025, 0.05, 0.95, and 0.975 quantiles of the skewness <span class="math inline">\(\sqrt{b_{1}}\)</span> under normality by a Monte Carlo experiment. Compute the standard error of the estimates from (2.14) using the normal approximation for the density (with exact variance formula). Compare the estimated quantiles with the quantiles of the large sample approximation <span class="math inline">\(\sqrt{b_{1}} \approx N(0,6 / n)\)</span>.</p>
</div>
<div id="answer-7" class="section level2">
<h2>Answer</h2>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb50-1" title="1"><span class="kw">set.seed</span>(<span class="dv">123</span>)</a>
<a class="sourceLine" id="cb50-2" title="2">N &lt;-<span class="st"> </span><span class="dv">50</span></a>
<a class="sourceLine" id="cb50-3" title="3">sk &lt;-<span class="st"> </span><span class="cf">function</span>(x) {</a>
<a class="sourceLine" id="cb50-4" title="4">                  xbar &lt;-<span class="st"> </span><span class="kw">mean</span>(x)</a>
<a class="sourceLine" id="cb50-5" title="5">                  m3 &lt;-<span class="st"> </span><span class="kw">mean</span>((x <span class="op">-</span><span class="st"> </span>xbar)<span class="op">^</span><span class="dv">3</span>)</a>
<a class="sourceLine" id="cb50-6" title="6">                  m2 &lt;-<span class="st"> </span><span class="kw">mean</span>((x <span class="op">-</span><span class="st"> </span>xbar)<span class="op">^</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb50-7" title="7">                  <span class="kw">return</span>( m3 <span class="op">/</span><span class="st"> </span>m2<span class="op">^</span><span class="fl">1.5</span> )</a>
<a class="sourceLine" id="cb50-8" title="8">}</a>
<a class="sourceLine" id="cb50-9" title="9">estimates &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>, N, <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb50-10" title="10"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N){</a>
<a class="sourceLine" id="cb50-11" title="11">  x &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">1000</span>)</a>
<a class="sourceLine" id="cb50-12" title="12">  estimates[i]&lt;-<span class="kw">sk</span>(x)</a>
<a class="sourceLine" id="cb50-13" title="13">}</a></code></pre></div>
<div id="estimate-the-0.025-0.05-0.95-and-0.975-quantiles" class="section level3">
<h3>Estimate the 0.025, 0.05, 0.95, and 0.975 quantiles</h3>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb51-1" title="1">q &lt;-<span class="st"> </span><span class="kw">numeric</span>(<span class="dv">4</span>)</a>
<a class="sourceLine" id="cb51-2" title="2">a &lt;-<span class="kw">c</span>(<span class="fl">0.025</span>,<span class="fl">0.05</span>,<span class="fl">0.95</span>,<span class="fl">0.975</span>)</a>
<a class="sourceLine" id="cb51-3" title="3"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>){</a>
<a class="sourceLine" id="cb51-4" title="4">           q[i]&lt;-<span class="st"> </span><span class="kw">quantile</span>(estimates,a[i])</a>
<a class="sourceLine" id="cb51-5" title="5">}</a>
<a class="sourceLine" id="cb51-6" title="6"><span class="kw">print</span>(q)</a></code></pre></div>
<pre><code>## [1] -0.1295104 -0.1133682  0.1453194  0.1473866</code></pre>
</div>
<div id="compute-the-standard-error-of-the-estimates" class="section level3">
<h3>Compute the standard error of the estimates</h3>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb53-1" title="1">var &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>, <span class="dv">4</span>, <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb53-2" title="2">g &lt;-<span class="st"> </span><span class="cf">function</span>(x){a[i]<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>a[i])<span class="op">/</span>(N<span class="op">*</span><span class="kw">dnorm</span>(x,<span class="dv">0</span>,<span class="dv">1</span>)<span class="op">^</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb53-3" title="3">}</a>
<a class="sourceLine" id="cb53-4" title="4"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>){</a>
<a class="sourceLine" id="cb53-5" title="5">            var[i] &lt;-<span class="st"> </span><span class="kw">g</span>(q[i])</a>
<a class="sourceLine" id="cb53-6" title="6">     }</a>
<a class="sourceLine" id="cb53-7" title="7"><span class="kw">print</span>(<span class="kw">sqrt</span>(var))</a></code></pre></div>
<pre><code>##            [,1]
## [1,] 0.05581095
## [2,] 0.07775755
## [3,] 0.07807957
## [4,] 0.05594925</code></pre>
</div>
<div id="the-quantiles-of-the-large-sample-approximation-sqrtb_1-approx-n06-n" class="section level3">
<h3>The quantiles of the large sample approximation <span class="math inline">\(\sqrt{b_{1}} \approx N(0,6 / n)\)</span></h3>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb55-1" title="1"><span class="kw">set.seed</span>(<span class="dv">123</span>)</a>
<a class="sourceLine" id="cb55-2" title="2">n &lt;-<span class="st"> </span><span class="dv">1000</span></a>
<a class="sourceLine" id="cb55-3" title="3">x &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n,<span class="dt">mean =</span> <span class="dv">0</span>,<span class="dt">sd=</span>(<span class="dv">6</span><span class="op">/</span>n)<span class="op">^</span>(<span class="dv">1</span><span class="op">/</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb55-4" title="4">q2 &lt;-<span class="st"> </span><span class="kw">numeric</span>(<span class="dv">4</span>)</a>
<a class="sourceLine" id="cb55-5" title="5">a &lt;-<span class="kw">c</span>(<span class="fl">0.025</span>,<span class="fl">0.05</span>,<span class="fl">0.95</span>,<span class="fl">0.975</span>)</a>
<a class="sourceLine" id="cb55-6" title="6"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>){</a>
<a class="sourceLine" id="cb55-7" title="7">           q2[i]&lt;-<span class="st"> </span><span class="kw">quantile</span>(x,a[i])</a>
<a class="sourceLine" id="cb55-8" title="8">}</a>
<a class="sourceLine" id="cb55-9" title="9"><span class="kw">print</span>(q2)</a></code></pre></div>
<pre><code>## [1] -0.1503922 -0.1256848  0.1298328  0.1578540</code></pre>
</div>
<div id="compare-the-quantiles" class="section level3">
<h3>Compare the quantiles</h3>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb57-1" title="1"><span class="kw">cbind</span>(q,q2)</a></code></pre></div>
<pre><code>##               q         q2
## [1,] -0.1295104 -0.1503922
## [2,] -0.1133682 -0.1256848
## [3,]  0.1453194  0.1298328
## [4,]  0.1473866  0.1578540</code></pre>
</div>
</div>
</div>
<div id="homework-5" class="section level1">
<h1>Homework 5</h1>
<div id="question-1" class="section level2">
<h2>Question 1</h2>
<p>Estimate the power of the skewness test of normality against symmetric Beta(<span class="math inline">\(\alpha\)</span>,<span class="math inline">\(\alpha\)</span>) distributions and comment on the results. Are the results different or heavy-tailed symmetric alternatives such as t(<span class="math inline">\(\nu\)</span>)?</p>
</div>
<div id="answer-1-1" class="section level2">
<h2>Answer 1</h2>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb59-1" title="1"><span class="kw">library</span>(energy)</a>
<a class="sourceLine" id="cb59-2" title="2"><span class="kw">set.seed</span>(<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb59-3" title="3">alpha &lt;-<span class="st"> </span><span class="fl">.05</span></a>
<a class="sourceLine" id="cb59-4" title="4">n &lt;-<span class="st"> </span><span class="dv">30</span></a>
<a class="sourceLine" id="cb59-5" title="5">m &lt;-<span class="st"> </span><span class="dv">2000</span> </a>
<a class="sourceLine" id="cb59-6" title="6">exam1 &lt;-<span class="st"> </span>exam2 &lt;-<span class="st"> </span><span class="kw">numeric</span>(m)</a>
<a class="sourceLine" id="cb59-7" title="7">para1 &lt;-<span class="st"> </span>para2 &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="dv">10</span></a>
<a class="sourceLine" id="cb59-8" title="8">pwr1 &lt;-<span class="st"> </span>pwr2 &lt;-<span class="st"> </span><span class="kw">numeric</span>(<span class="dv">10</span>)</a>
<a class="sourceLine" id="cb59-9" title="9"></a>
<a class="sourceLine" id="cb59-10" title="10"><span class="co">## Estimate the power of the skewness test of normality against symmetric Beta(α, α) distributions</span></a>
<a class="sourceLine" id="cb59-11" title="11"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">10</span>) {</a>
<a class="sourceLine" id="cb59-12" title="12">  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m) {</a>
<a class="sourceLine" id="cb59-13" title="13">    x &lt;-<span class="st"> </span><span class="kw">rbeta</span>(n,para1[i],para1[i]) </a>
<a class="sourceLine" id="cb59-14" title="14">    exam1[j] &lt;-<span class="st"> </span><span class="kw">as.integer</span>(</a>
<a class="sourceLine" id="cb59-15" title="15">    <span class="kw">shapiro.test</span>(x)<span class="op">$</span>p.value <span class="op">&lt;=</span><span class="st"> </span>alpha)</a>
<a class="sourceLine" id="cb59-16" title="16">  }</a>
<a class="sourceLine" id="cb59-17" title="17">  pwr1[i] &lt;-<span class="st"> </span><span class="kw">mean</span>(exam1)</a>
<a class="sourceLine" id="cb59-18" title="18">}</a>
<a class="sourceLine" id="cb59-19" title="19"><span class="kw">plot</span>(para1,pwr1,<span class="dt">main =</span> <span class="st">&quot;curve 1&quot;</span>,<span class="dt">xlab =</span> <span class="st">&quot;α&quot;</span>,<span class="dt">ylab =</span> <span class="st">&quot;power&quot;</span>,<span class="dt">type =</span> <span class="st">&quot;b&quot;</span>,<span class="dt">col =</span> <span class="st">&quot;blue&quot;</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb60-1" title="1"><span class="kw">print</span>(pwr1)</a></code></pre></div>
<pre><code>##  [1] 0.3910 0.0880 0.0465 0.0480 0.0395 0.0410 0.0345 0.0365 0.0355 0.0395</code></pre>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb62-1" title="1"><span class="co">#Estimate the power of the skewness test of normality against symmetric t(ν) distributions</span></a>
<a class="sourceLine" id="cb62-2" title="2"><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">10</span>) {</a>
<a class="sourceLine" id="cb62-3" title="3">  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m) {</a>
<a class="sourceLine" id="cb62-4" title="4">    y &lt;-<span class="st"> </span><span class="kw">rt</span>(n,para2[j]) </a>
<a class="sourceLine" id="cb62-5" title="5">    exam2[i] &lt;-<span class="st"> </span><span class="kw">as.integer</span>(</a>
<a class="sourceLine" id="cb62-6" title="6">    <span class="kw">shapiro.test</span>(y)<span class="op">$</span>p.value <span class="op">&lt;=</span><span class="st"> </span>alpha)</a>
<a class="sourceLine" id="cb62-7" title="7">  }</a>
<a class="sourceLine" id="cb62-8" title="8">  pwr2[j] &lt;-<span class="st"> </span><span class="kw">mean</span>(exam2)</a>
<a class="sourceLine" id="cb62-9" title="9">}</a>
<a class="sourceLine" id="cb62-10" title="10"><span class="kw">plot</span>(para2,pwr2,<span class="dt">main =</span> <span class="st">&quot;curve 2&quot;</span>,<span class="dt">xlab =</span> <span class="st">&quot;ν&quot;</span>,<span class="dt">ylab =</span> <span class="st">&quot;power&quot;</span>,<span class="dt">type =</span> <span class="st">&quot;b&quot;</span>,<span class="dt">col =</span> <span class="st">&quot;blue&quot;</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb63-1" title="1"><span class="kw">print</span>(pwr2)</a></code></pre></div>
<pre><code>##  [1] 0.9635 0.6780 0.4655 0.3455 0.2630 0.1945 0.1755 0.1300 0.1330 0.1180</code></pre>
<p><em>Conclusion:</em> From the figure curve 1, we can find that the value of the power falls from o.38 to 0.03. And from the figure curve 2, we can find that it is similar to the curve 1, but in the curve 2, the range is even wider,which means t(ν) is more closer to normal distribution than Beta(α, α).</p>
</div>
<div id="question-2" class="section level2">
<h2>Question 2</h2>
<p>Use Monte Carlo simulation to investigate whether the empirical Type I error rate of the t-test is approximately equal to nominal significance level <span class="math inline">\(\alpha\)</span>, when the sampled population is non-normal. The t-test is robust to mild departures from normality. Discuss the simulation results for the cases where the sampled population is (i) <span class="math inline">\(\chi^2(1)\)</span>, (ii) Uniform(0,2), and (iii) Exponential(rate=1). In each case, test <span class="math inline">\(H_0:\mu=\mu_0\)</span> vs <span class="math inline">\(H_1:\mu \neq \mu_0\)</span>, where <span class="math inline">\(\mu_0\)</span> is the mean of <span class="math inline">\(\chi^2(1)\)</span>, Uniform(0,2), and Exponential(1), respectively.</p>
</div>
<div id="answer-2-1" class="section level2">
<h2>Answer 2</h2>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb65-1" title="1"><span class="kw">set.seed</span>(<span class="dv">12345678</span>)</a>
<a class="sourceLine" id="cb65-2" title="2">n&lt;-<span class="dv">50</span></a>
<a class="sourceLine" id="cb65-3" title="3">alpha &lt;-<span class="st"> </span><span class="fl">.05</span> </a>
<a class="sourceLine" id="cb65-4" title="4">a&lt;-<span class="dv">1</span></a>
<a class="sourceLine" id="cb65-5" title="5">mu0&lt;-<span class="dv">1</span></a>
<a class="sourceLine" id="cb65-6" title="6">m &lt;-<span class="st"> </span><span class="dv">10000</span></a>
<a class="sourceLine" id="cb65-7" title="7"><span class="co">#number of replicates</span></a>
<a class="sourceLine" id="cb65-8" title="8">p &lt;-<span class="st"> </span><span class="kw">numeric</span>(m) </a>
<a class="sourceLine" id="cb65-9" title="9"><span class="co">#storage for p-values </span></a>
<a class="sourceLine" id="cb65-10" title="10"><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m) { </a>
<a class="sourceLine" id="cb65-11" title="11">  x &lt;-<span class="st"> </span><span class="kw">rchisq</span>(n, <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb65-12" title="12">  ttest &lt;-<span class="st"> </span><span class="kw">t.test</span>(x, <span class="dt">alternative =</span> <span class="st">&quot;two.sided&quot;</span>, <span class="dt">mu =</span> mu0) </a>
<a class="sourceLine" id="cb65-13" title="13">  p[j] &lt;-<span class="st"> </span>ttest<span class="op">$</span>p.value</a>
<a class="sourceLine" id="cb65-14" title="14">  }</a>
<a class="sourceLine" id="cb65-15" title="15">p.hat &lt;-<span class="st"> </span><span class="kw">mean</span>(p <span class="op">&lt;</span><span class="st"> </span>alpha)</a>
<a class="sourceLine" id="cb65-16" title="16"><span class="kw">print</span>(p.hat)</a></code></pre></div>
<pre><code>## [1] 0.0797</code></pre>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb67-1" title="1"><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m) { </a>
<a class="sourceLine" id="cb67-2" title="2">  x &lt;-<span class="st"> </span><span class="kw">runif</span>(n, <span class="dv">0</span>, <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb67-3" title="3">  ttest &lt;-<span class="st"> </span><span class="kw">t.test</span>(x, <span class="dt">alternative =</span> <span class="st">&quot;two.sided&quot;</span>, <span class="dt">mu =</span> mu0) </a>
<a class="sourceLine" id="cb67-4" title="4">  p[j] &lt;-<span class="st"> </span>ttest<span class="op">$</span>p.value</a>
<a class="sourceLine" id="cb67-5" title="5">  }</a>
<a class="sourceLine" id="cb67-6" title="6">p.hat &lt;-<span class="st"> </span><span class="kw">mean</span>(p <span class="op">&lt;</span><span class="st"> </span>alpha)</a>
<a class="sourceLine" id="cb67-7" title="7"><span class="kw">print</span>(p.hat)</a></code></pre></div>
<pre><code>## [1] 0.0516</code></pre>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb69-1" title="1"><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m) { </a>
<a class="sourceLine" id="cb69-2" title="2">  x &lt;-<span class="st"> </span><span class="kw">rexp</span>(n, <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb69-3" title="3">  ttest &lt;-<span class="st"> </span><span class="kw">t.test</span>(x, <span class="dt">alternative =</span> <span class="st">&quot;two.sided&quot;</span>, <span class="dt">mu =</span> mu0) </a>
<a class="sourceLine" id="cb69-4" title="4">  p[j] &lt;-<span class="st"> </span>ttest<span class="op">$</span>p.value</a>
<a class="sourceLine" id="cb69-5" title="5">  }</a>
<a class="sourceLine" id="cb69-6" title="6">p.hat &lt;-<span class="st"> </span><span class="kw">mean</span>(p <span class="op">&lt;</span><span class="st"> </span>alpha)</a>
<a class="sourceLine" id="cb69-7" title="7"><span class="kw">print</span>(p.hat)</a></code></pre></div>
<pre><code>## [1] 0.0679</code></pre>
</div>
<div id="discussion-3" class="section level2">
<h2>discussion 3</h2>
<p>If we obtain the powers for two methods under a particular simulation setting with 10000 experiments: say, 0.651 for one method and 0.676 for another method. Can we say the powers are different at 0.05 level?</p>
<p>1.What is the corresponding hypothesis test problem?</p>
<p>2.What test should we use? Z-test, two-sample test, paired-t test or McNemar test?</p>
<p>3.What information is needed to test your hypothesis?</p>
</div>
<div id="answer-3-1" class="section level2">
<h2>Answer 3</h2>
<div id="section" class="section level5">
<h5>1.</h5>
<p><span class="math display">\[H_{0}: \text { power } 1=\text { power } 2 \quad \text { versus } \quad H_{1}: \text { power } 1 \neq \text { power } 2\]</span></p>
</div>
<div id="i-think-we-should-use-mcnemar-test.-first-mcnemar-test-is-suitable-for-chi-square-test-of-non-independent-samples.-in-this-test-the-z-assignment-test-is-based-on-a-large-sample-size.-and-the-test-is-for-the-difference-in-the-proportion-of-dependent-samples." class="section level5">
<h5>2. I think we should use McNemar test. First, McNemar test is suitable for Chi-square test of non-independent samples. In this test, the z-assignment test is based on a large sample size. And the test is for the difference in the proportion of dependent samples.</h5>
</div>
<div id="the-number-of-simultanously-regection." class="section level5">
<h5>3. The number of simultanously regection.</h5>
</div>
</div>
</div>
<div id="homework-6" class="section level1">
<h1>Homework 6</h1>
<div id="question-7.6" class="section level2">
<h2>Question 7.6</h2>
<p>Efron and Tibshirani discuss the scor (bootstrap) test score data on 88 students who took examinations in five subjects [84, Table 7.1], [188, Table 1.2.1]. The first two tests (mechanics, vectors) were closed book and the last three tests (algebra, analysis, statistics) were open book. Each row of the data frame is a set of scores <span class="math inline">\(\left(x_{i 1}, \dots, x_{i 5}\right)\)</span> for the <span class="math inline">\(i^{t h}\)</span> student. Use a panel display to display the scatter plots for each pair of test scores. Compare the plot with the sample correlation matrix. Obtain bootstrap estimates of the standard errors for each of the following estimates:<span class="math inline">\(\hat{\rho}_{12}=\hat{\rho}(\mathrm{mec}, \mathrm{vec}), \hat{\rho}_{34}=\hat{\rho}(\mathrm{alg,ana})\)</span>, <span class="math inline">\(\hat{\rho}_{35}=\hat{\rho}(\text { alg, sta }), \hat{\rho}_{45}=\hat{\rho}(\text { ana }, \text { sta })\)</span>.</p>
</div>
<div id="answer-7.6" class="section level2">
<h2>Answer 7.6</h2>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb71-1" title="1"><span class="kw">library</span>(bootstrap)</a>
<a class="sourceLine" id="cb71-2" title="2"><span class="co">## Use a panel display to display the scatter plots for each pair of test scores.</span></a>
<a class="sourceLine" id="cb71-3" title="3"><span class="kw">library</span>(ggplot2)</a>
<a class="sourceLine" id="cb71-4" title="4"><span class="kw">pairs</span>(<span class="op">~</span>mec<span class="op">+</span>vec<span class="op">+</span>alg<span class="op">+</span>ana<span class="op">+</span>sta,scor)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb72-1" title="1"><span class="co">##  Compare the plot with the sample correlation matrix.</span></a>
<a class="sourceLine" id="cb72-2" title="2"><span class="kw">cor</span>(scor)</a></code></pre></div>
<pre><code>##           mec       vec       alg       ana       sta
## mec 1.0000000 0.5534052 0.5467511 0.4093920 0.3890993
## vec 0.5534052 1.0000000 0.6096447 0.4850813 0.4364487
## alg 0.5467511 0.6096447 1.0000000 0.7108059 0.6647357
## ana 0.4093920 0.4850813 0.7108059 1.0000000 0.6071743
## sta 0.3890993 0.4364487 0.6647357 0.6071743 1.0000000</code></pre>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb74-1" title="1"><span class="co">##  Obtain bootstrap estimates of the standard errors for each of the following estimates.</span></a>
<a class="sourceLine" id="cb74-2" title="2"><span class="co">#set up the bootstrap</span></a>
<a class="sourceLine" id="cb74-3" title="3">B &lt;-<span class="st"> </span><span class="dv">200</span> </a>
<a class="sourceLine" id="cb74-4" title="4">n &lt;-<span class="st"> </span><span class="kw">nrow</span>(scor)</a>
<a class="sourceLine" id="cb74-5" title="5">rho12 &lt;-<span class="st"> </span><span class="kw">numeric</span>(B)</a>
<a class="sourceLine" id="cb74-6" title="6"><span class="kw">set.seed</span>(<span class="dv">1234</span>)</a></code></pre></div>
<div id="bootstrap-estimate-of-standard-error-of" class="section level5">
<h5>bootstrap estimate of standard error of</h5>
<p><span class="math inline">\(\hat{\rho}_{12}=\hat{\rho}(\mathrm{mec}, \mathrm{vec})\)</span></p>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb75-1" title="1"><span class="cf">for</span> (b <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>B) {</a>
<a class="sourceLine" id="cb75-2" title="2">i &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span>n, <span class="dt">size =</span> n, <span class="dt">replace =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb75-3" title="3">mec &lt;-<span class="st"> </span>scor<span class="op">$</span>mec[i]</a>
<a class="sourceLine" id="cb75-4" title="4">vec &lt;-<span class="st"> </span>scor<span class="op">$</span>vec[i]</a>
<a class="sourceLine" id="cb75-5" title="5">rho12[b] &lt;-<span class="st"> </span><span class="kw">cor</span>(mec, vec)</a>
<a class="sourceLine" id="cb75-6" title="6">}</a>
<a class="sourceLine" id="cb75-7" title="7"></a>
<a class="sourceLine" id="cb75-8" title="8"><span class="co">#output</span></a>
<a class="sourceLine" id="cb75-9" title="9"><span class="kw">print</span>(se.rho12 &lt;-<span class="st"> </span><span class="kw">sd</span>(rho12))</a></code></pre></div>
<pre><code>## [1] 0.07476741</code></pre>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb77-1" title="1"><span class="kw">hist</span>(rho12, <span class="dt">prob =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb77-2" title="2"><span class="kw">lines</span>(<span class="kw">density</span>(rho12))</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="bootstrap-estimate-of-standard-error-of-1" class="section level5">
<h5>bootstrap estimate of standard error of</h5>
<p><span class="math inline">\(\hat{\rho}_{34}=\hat{\rho}(\mathrm{alg}, \mathrm{ana})\)</span></p>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb78-1" title="1">rho34 &lt;-<span class="st"> </span><span class="kw">numeric</span>(B)</a>
<a class="sourceLine" id="cb78-2" title="2"><span class="cf">for</span> (b <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>B) {</a>
<a class="sourceLine" id="cb78-3" title="3">i &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span>n, <span class="dt">size =</span> n, <span class="dt">replace =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb78-4" title="4">alg &lt;-<span class="st"> </span>scor<span class="op">$</span>alg[i]</a>
<a class="sourceLine" id="cb78-5" title="5">ana &lt;-<span class="st"> </span>scor<span class="op">$</span>ana[i]</a>
<a class="sourceLine" id="cb78-6" title="6">rho34[b] &lt;-<span class="st"> </span><span class="kw">cor</span>(alg, ana)</a>
<a class="sourceLine" id="cb78-7" title="7">}</a>
<a class="sourceLine" id="cb78-8" title="8"></a>
<a class="sourceLine" id="cb78-9" title="9"><span class="co">#output</span></a>
<a class="sourceLine" id="cb78-10" title="10"><span class="kw">print</span>(se.rho34 &lt;-<span class="st"> </span><span class="kw">sd</span>(rho34))</a></code></pre></div>
<pre><code>## [1] 0.05057228</code></pre>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb80-1" title="1"><span class="kw">hist</span>(rho34, <span class="dt">prob =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb80-2" title="2"><span class="kw">lines</span>(<span class="kw">density</span>(rho34))</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="bootstrap-estimate-of-standard-error-of-2" class="section level5">
<h5>bootstrap estimate of standard error of</h5>
<p><span class="math inline">\(\hat{\rho}_{35}=\hat{\rho}(\mathrm{alg}, \mathrm{sta})\)</span></p>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb81-1" title="1">rho35 &lt;-<span class="st"> </span><span class="kw">numeric</span>(B)</a>
<a class="sourceLine" id="cb81-2" title="2"><span class="cf">for</span> (b <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>B) {</a>
<a class="sourceLine" id="cb81-3" title="3">i &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span>n, <span class="dt">size =</span> n, <span class="dt">replace =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb81-4" title="4">alg &lt;-<span class="st"> </span>scor<span class="op">$</span>alg[i]</a>
<a class="sourceLine" id="cb81-5" title="5">sta &lt;-<span class="st"> </span>scor<span class="op">$</span>sta[i]</a>
<a class="sourceLine" id="cb81-6" title="6">rho35[b] &lt;-<span class="st"> </span><span class="kw">cor</span>(alg, sta)</a>
<a class="sourceLine" id="cb81-7" title="7">}</a>
<a class="sourceLine" id="cb81-8" title="8"></a>
<a class="sourceLine" id="cb81-9" title="9"><span class="co">#output</span></a>
<a class="sourceLine" id="cb81-10" title="10"><span class="kw">print</span>(se.rho35 &lt;-<span class="st"> </span><span class="kw">sd</span>(rho35))</a></code></pre></div>
<pre><code>## [1] 0.06328222</code></pre>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb83-1" title="1"><span class="kw">hist</span>(rho35, <span class="dt">prob =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb83-2" title="2"><span class="kw">lines</span>(<span class="kw">density</span>(rho35))</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="bootstrap-estimate-of-standard-error-of-3" class="section level5">
<h5>bootstrap estimate of standard error of</h5>
<p><span class="math inline">\(\hat{\rho}_{45}=\hat{\rho}(\mathrm{ana}, \mathrm{sta})\)</span></p>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb84-1" title="1">rho45 &lt;-<span class="st"> </span><span class="kw">numeric</span>(B)</a>
<a class="sourceLine" id="cb84-2" title="2"><span class="cf">for</span> (b <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>B) {</a>
<a class="sourceLine" id="cb84-3" title="3">i &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span>n, <span class="dt">size =</span> n, <span class="dt">replace =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb84-4" title="4">ana &lt;-<span class="st"> </span>scor<span class="op">$</span>ana[i]</a>
<a class="sourceLine" id="cb84-5" title="5">sta &lt;-<span class="st"> </span>scor<span class="op">$</span>sta[i]</a>
<a class="sourceLine" id="cb84-6" title="6">rho45[b] &lt;-<span class="st"> </span><span class="kw">cor</span>(ana, sta)</a>
<a class="sourceLine" id="cb84-7" title="7">}</a>
<a class="sourceLine" id="cb84-8" title="8"></a>
<a class="sourceLine" id="cb84-9" title="9"><span class="co">#output</span></a>
<a class="sourceLine" id="cb84-10" title="10"><span class="kw">print</span>(se.rho45 &lt;-<span class="st"> </span><span class="kw">sd</span>(rho45))</a></code></pre></div>
<pre><code>## [1] 0.06668089</code></pre>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb86-1" title="1"><span class="kw">hist</span>(rho45, <span class="dt">prob =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb86-2" title="2"><span class="kw">lines</span>(<span class="kw">density</span>(rho45))</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb87-1" title="1"><span class="co">## Conclusion</span></a>
<a class="sourceLine" id="cb87-2" title="2"><span class="kw">library</span>(knitr)</a>
<a class="sourceLine" id="cb87-3" title="3"><span class="kw">library</span>(kableExtra)</a>
<a class="sourceLine" id="cb87-4" title="4">knitr<span class="op">::</span><span class="kw">kable</span>(<span class="kw">cbind</span>(se.rho12,se.rho34,se.rho35,se.rho45),<span class="dt">formate =</span> <span class="st">&quot;html&quot;</span>,<span class="dt">col.names =</span> <span class="kw">c</span>(<span class="st">&quot;sd of rho12&quot;</span>,<span class="st">&quot;sd of rho34&quot;</span>,<span class="st">&quot;sd of rho35&quot;</span>,<span class="st">&quot;sd of rho45&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">kable_styling</span>(<span class="dt">position =</span> <span class="st">&quot;center&quot;</span>)</a></code></pre></div>
<table class="table" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:right;">
sd of rho12
</th>
<th style="text-align:right;">
sd of rho34
</th>
<th style="text-align:right;">
sd of rho35
</th>
<th style="text-align:right;">
sd of rho45
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
0.0747674
</td>
<td style="text-align:right;">
0.0505723
</td>
<td style="text-align:right;">
0.0632822
</td>
<td style="text-align:right;">
0.0666809
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="b" class="section level2">
<h2>7.B</h2>
<p>Repeat Project 7.A for the sample skewness statistic. Compare the coverage rates for normal populations (skewness 0) and <span class="math inline">\(\chi^{2}(5)\)</span> distributions (positive skewness).</p>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb88-1" title="1"><span class="co">## basic settings</span></a>
<a class="sourceLine" id="cb88-2" title="2"><span class="kw">library</span>(boot)</a>
<a class="sourceLine" id="cb88-3" title="3">n&lt;-<span class="fl">1e2</span></a>
<a class="sourceLine" id="cb88-4" title="4"><span class="kw">set.seed</span>(<span class="dv">012345678</span>)</a>
<a class="sourceLine" id="cb88-5" title="5">mu&lt;-<span class="dv">0</span>;b&lt;-<span class="dv">1</span>;m&lt;-<span class="dv">80</span></a>
<a class="sourceLine" id="cb88-6" title="6">sk&lt;-<span class="st"> </span><span class="cf">function</span>(x,i) {</a>
<a class="sourceLine" id="cb88-7" title="7">  xbar &lt;-<span class="st"> </span><span class="kw">mean</span>(x[i])</a>
<a class="sourceLine" id="cb88-8" title="8">  m3 &lt;-<span class="st"> </span><span class="kw">mean</span>((x[i] <span class="op">-</span><span class="st"> </span>xbar)<span class="op">^</span><span class="dv">3</span>) </a>
<a class="sourceLine" id="cb88-9" title="9">  m2 &lt;-<span class="st"> </span><span class="kw">mean</span>((x [i]<span class="op">-</span><span class="st"> </span>xbar)<span class="op">^</span><span class="dv">2</span>) </a>
<a class="sourceLine" id="cb88-10" title="10">  <span class="kw">return</span>( m3 <span class="op">/</span><span class="st"> </span>m2<span class="op">^</span><span class="fl">1.5</span> )</a>
<a class="sourceLine" id="cb88-11" title="11">}</a>
<a class="sourceLine" id="cb88-12" title="12"><span class="co">## compute the coverage rates for normal populations</span></a>
<a class="sourceLine" id="cb88-13" title="13">norm_cil&lt;-norm_cir&lt;-basic_cil&lt;-basic_cir&lt;-perc_cil&lt;-perc_cir&lt;-<span class="kw">numeric</span>(n)</a>
<a class="sourceLine" id="cb88-14" title="14"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){ </a>
<a class="sourceLine" id="cb88-15" title="15"> U&lt;-<span class="kw">rnorm</span>(m,<span class="dv">0</span>,<span class="dv">1</span>) </a>
<a class="sourceLine" id="cb88-16" title="16">  de &lt;-<span class="st"> </span><span class="kw">boot</span>(<span class="dt">data=</span>U,<span class="dt">statistic=</span>sk, <span class="dt">R =</span> <span class="dv">2000</span>) </a>
<a class="sourceLine" id="cb88-17" title="17">  ci &lt;-<span class="st"> </span><span class="kw">boot.ci</span>(de ,<span class="dt">type=</span><span class="kw">c</span>(<span class="st">&quot;norm&quot;</span>,<span class="st">&quot;basic&quot;</span>,<span class="st">&quot;perc&quot;</span>))</a>
<a class="sourceLine" id="cb88-18" title="18">  norm_cil[i]&lt;-ci<span class="op">$</span>normal[<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb88-19" title="19">  norm_cir[i]&lt;-ci<span class="op">$</span>normal[<span class="dv">3</span>]</a>
<a class="sourceLine" id="cb88-20" title="20">  basic_cil[i]&lt;-ci<span class="op">$</span>basic[<span class="dv">4</span>]</a>
<a class="sourceLine" id="cb88-21" title="21">  basic_cir[i]&lt;-ci<span class="op">$</span>basic[<span class="dv">5</span>]</a>
<a class="sourceLine" id="cb88-22" title="22">  perc_cil[i]&lt;-ci<span class="op">$</span>percent[<span class="dv">4</span>]</a>
<a class="sourceLine" id="cb88-23" title="23">  perc_cir[i]&lt;-ci<span class="op">$</span>percent[<span class="dv">5</span>]</a>
<a class="sourceLine" id="cb88-24" title="24">}</a>
<a class="sourceLine" id="cb88-25" title="25"><span class="kw">cat</span>(<span class="st">&#39;norm =&#39;</span>,<span class="kw">round</span>(<span class="kw">mean</span>(norm_cil<span class="op">&lt;=</span>mu <span class="op">&amp;</span><span class="st"> </span>norm_cir<span class="op">&gt;=</span>mu),<span class="dv">4</span>), </a>
<a class="sourceLine" id="cb88-26" title="26">    <span class="st">&#39;basic =&#39;</span>,<span class="kw">mean</span>(basic_cil<span class="op">&lt;=</span>mu <span class="op">&amp;</span><span class="st"> </span>basic_cir<span class="op">&gt;=</span>mu), <span class="st">&#39;perc =&#39;</span>,<span class="kw">mean</span>(perc_cil<span class="op">&lt;=</span>mu <span class="op">&amp;</span><span class="st"> </span>perc_cir<span class="op">&gt;=</span>mu))</a></code></pre></div>
<pre><code>## norm = 0.93 basic = 0.94 perc = 0.95</code></pre>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb90-1" title="1"><span class="co">#  compute the coverage rates for chi-square(5) distributions</span></a>
<a class="sourceLine" id="cb90-2" title="2"><span class="kw">set.seed</span>(<span class="dv">012345678</span>)</a>
<a class="sourceLine" id="cb90-3" title="3">sk&lt;-<span class="st"> </span><span class="cf">function</span>(x,i) {</a>
<a class="sourceLine" id="cb90-4" title="4">  xbar &lt;-<span class="st"> </span><span class="kw">mean</span>(x[i])</a>
<a class="sourceLine" id="cb90-5" title="5">  m3 &lt;-<span class="st"> </span><span class="kw">mean</span>((x[i] <span class="op">-</span><span class="st"> </span>xbar)<span class="op">^</span><span class="dv">3</span>) </a>
<a class="sourceLine" id="cb90-6" title="6">  m2 &lt;-<span class="st"> </span><span class="kw">mean</span>((x [i]<span class="op">-</span><span class="st"> </span>xbar)<span class="op">^</span><span class="dv">2</span>) </a>
<a class="sourceLine" id="cb90-7" title="7">  <span class="kw">return</span>( m3 <span class="op">/</span><span class="st"> </span>m2<span class="op">^</span><span class="fl">1.5</span> )</a>
<a class="sourceLine" id="cb90-8" title="8">}</a>
<a class="sourceLine" id="cb90-9" title="9">n&lt;-<span class="dv">500</span>      </a>
<a class="sourceLine" id="cb90-10" title="10">m&lt;-<span class="dv">200</span>      </a>
<a class="sourceLine" id="cb90-11" title="11">norm_cil&lt;-norm_cir&lt;-basic_cil&lt;-basic_cir&lt;-perc_cil&lt;-perc_cir&lt;-<span class="kw">numeric</span>(n)</a>
<a class="sourceLine" id="cb90-12" title="12"></a>
<a class="sourceLine" id="cb90-13" title="13"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n) {</a>
<a class="sourceLine" id="cb90-14" title="14">  x&lt;-<span class="kw">rchisq</span>(m,<span class="dv">5</span>)</a>
<a class="sourceLine" id="cb90-15" title="15">  boot.obj&lt;-<span class="kw">boot</span>(x,<span class="dt">statistic=</span>sk,<span class="dt">R=</span><span class="dv">2000</span>)</a>
<a class="sourceLine" id="cb90-16" title="16">  ci&lt;-<span class="kw">boot.ci</span>(boot.obj,<span class="dt">type=</span><span class="kw">c</span>(<span class="st">&#39;norm&#39;</span>,<span class="st">&#39;basic&#39;</span>,<span class="st">&#39;perc&#39;</span>))</a>
<a class="sourceLine" id="cb90-17" title="17">  norm_cil[i]&lt;-ci<span class="op">$</span>normal[<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb90-18" title="18">  norm_cir[i]&lt;-ci<span class="op">$</span>normal[<span class="dv">3</span>]</a>
<a class="sourceLine" id="cb90-19" title="19">  basic_cil[i]&lt;-ci<span class="op">$</span>basic[<span class="dv">4</span>]</a>
<a class="sourceLine" id="cb90-20" title="20">  basic_cir[i]&lt;-ci<span class="op">$</span>basic[<span class="dv">5</span>]</a>
<a class="sourceLine" id="cb90-21" title="21">  perc_cil[i]&lt;-ci<span class="op">$</span>percent[<span class="dv">4</span>]</a>
<a class="sourceLine" id="cb90-22" title="22">  perc_cir[i]&lt;-ci<span class="op">$</span>percent[<span class="dv">5</span>]</a>
<a class="sourceLine" id="cb90-23" title="23">}</a>
<a class="sourceLine" id="cb90-24" title="24"><span class="co"># compute coverage rates </span></a>
<a class="sourceLine" id="cb90-25" title="25">a&lt;-<span class="kw">sqrt</span>(<span class="dv">8</span><span class="op">/</span><span class="dv">5</span>) </a>
<a class="sourceLine" id="cb90-26" title="26"><span class="kw">print</span>(<span class="kw">c</span>(<span class="kw">mean</span>((norm_cil<span class="op">&lt;</span>a)<span class="op">*</span>(norm_cir<span class="op">&gt;</span>a)),<span class="kw">mean</span>((basic_cil<span class="op">&lt;</span>a)<span class="op">*</span>(basic_cir<span class="op">&gt;</span>a)),<span class="kw">mean</span>((perc_cil<span class="op">&lt;</span>a)<span class="op">*</span>(perc_cir<span class="op">&gt;</span>a))))</a></code></pre></div>
<pre><code>## [1] 0.814 0.808 0.802</code></pre>
</div>
</div>
<div id="homework-7" class="section level1">
<h1>Homework 7</h1>
<div id="question-7.8" class="section level2">
<h2>Question 7.8</h2>
<p>Refer to Exercise 7.7. Obtain the jackknife estimates of bias and standard error of <span class="math inline">\(\hat{\theta}\)</span>.</p>
</div>
<div id="answer-8" class="section level2">
<h2>Answer</h2>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb92-1" title="1"><span class="kw">set.seed</span>(<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb92-2" title="2"><span class="kw">library</span>(bootstrap)</a>
<a class="sourceLine" id="cb92-3" title="3"><span class="kw">library</span>(knitr)</a>
<a class="sourceLine" id="cb92-4" title="4">lamda_hat &lt;-<span class="st"> </span><span class="kw">eigen</span>(<span class="kw">cov</span>(scor))<span class="op">$</span>values</a>
<a class="sourceLine" id="cb92-5" title="5">theta_hat &lt;-<span class="st"> </span>lamda_hat[<span class="dv">1</span>]<span class="op">/</span><span class="kw">sum</span>(lamda_hat)</a>
<a class="sourceLine" id="cb92-6" title="6"><span class="kw">print</span>(theta_hat)</a></code></pre></div>
<pre><code>## [1] 0.619115</code></pre>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb94-1" title="1">n&lt;-<span class="kw">nrow</span>(scor)</a>
<a class="sourceLine" id="cb94-2" title="2">theta.j&lt;-<span class="kw">numeric</span>(n)</a>
<a class="sourceLine" id="cb94-3" title="3">ev&lt;-<span class="kw">matrix</span>(<span class="dt">nrow =</span> <span class="dv">88</span>,<span class="dt">ncol =</span> <span class="dv">5</span>)</a>
<a class="sourceLine" id="cb94-4" title="4"></a>
<a class="sourceLine" id="cb94-5" title="5"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n){</a>
<a class="sourceLine" id="cb94-6" title="6">  ev[i,]&lt;-<span class="st"> </span><span class="kw">eigen</span>(<span class="kw">cov</span>(scor[<span class="op">-</span>i,]))<span class="op">$</span>values  </a>
<a class="sourceLine" id="cb94-7" title="7">  theta.j[i]&lt;-ev[i,<span class="dv">1</span>]<span class="op">/</span><span class="kw">sum</span>(ev[i,])}</a>
<a class="sourceLine" id="cb94-8" title="8"></a>
<a class="sourceLine" id="cb94-9" title="9">bias.j&lt;-(n<span class="dv">-1</span>)<span class="op">*</span>(<span class="kw">mean</span>(theta.j)<span class="op">-</span>theta_hat)</a>
<a class="sourceLine" id="cb94-10" title="10">se.j&lt;-<span class="kw">sqrt</span>((n<span class="dv">-1</span>)<span class="op">*</span><span class="kw">mean</span>((theta.j<span class="op">-</span><span class="kw">mean</span>(theta.j))<span class="op">^</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb94-11" title="11"><span class="kw">print</span>(bias.j)</a></code></pre></div>
<pre><code>## [1] 0.001069139</code></pre>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb96-1" title="1"><span class="kw">print</span>(se.j)</a></code></pre></div>
<pre><code>## [1] 0.04955231</code></pre>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb98-1" title="1"><span class="kw">library</span>(kableExtra)</a>
<a class="sourceLine" id="cb98-2" title="2">knitr<span class="op">::</span><span class="kw">kable</span>(<span class="kw">cbind</span>(theta_hat,bias.j,se.j),<span class="dt">formate =</span> <span class="st">&quot;html&quot;</span>,<span class="dt">col.names =</span> <span class="kw">c</span>(<span class="st">&quot;theta_hat&quot;</span>,<span class="st">&quot;bias.j&quot;</span>,<span class="st">&quot;se.j&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">kable_styling</span>(<span class="dt">position =</span> <span class="st">&quot;center&quot;</span>)</a></code></pre></div>
<table class="table" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:right;">
theta_hat
</th>
<th style="text-align:right;">
bias.j
</th>
<th style="text-align:right;">
se.j
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
0.619115
</td>
<td style="text-align:right;">
0.0010691
</td>
<td style="text-align:right;">
0.0495523
</td>
</tr>
</tbody>
</table>
</div>
<div id="question-7.10" class="section level2">
<h2>Question 7.10</h2>
<p>In Example 7.18, leave-one-out (n-fold) cross validation was used to select the best fitting model. Repeat the analysis replacing the Log-Log model with a cubic polynomial model. Which of the four models is selected by the cross validation procedure? Which model is selected according to maximum adjusted <span class="math inline">\(R^{2}\)</span>?</p>
</div>
<div id="answer-9" class="section level2">
<h2>Answer</h2>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb99-1" title="1"><span class="kw">set.seed</span>(<span class="dv">123</span>)</a>
<a class="sourceLine" id="cb99-2" title="2"><span class="kw">library</span>(DAAG); <span class="kw">attach</span>(ironslag)</a></code></pre></div>
<pre><code>## 载入需要的程辑包：lattice</code></pre>
<pre><code>## 
## 载入程辑包：&#39;lattice&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:boot&#39;:
## 
##     melanoma</code></pre>
<pre><code>## 
## 载入程辑包：&#39;DAAG&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:MASS&#39;:
## 
##     hills</code></pre>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb105-1" title="1">a &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">10</span>, <span class="dv">40</span>, <span class="fl">.1</span>) <span class="co">#sequence for plotting fits</span></a>
<a class="sourceLine" id="cb105-2" title="2"></a>
<a class="sourceLine" id="cb105-3" title="3"><span class="kw">par</span>(<span class="dt">mar=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>))</a>
<a class="sourceLine" id="cb105-4" title="4">L1 &lt;-<span class="st"> </span><span class="kw">lm</span>(magnetic <span class="op">~</span><span class="st"> </span>chemical)</a>
<a class="sourceLine" id="cb105-5" title="5"><span class="kw">plot</span>(chemical, magnetic, <span class="dt">main=</span><span class="st">&quot;Linear&quot;</span>, <span class="dt">pch=</span><span class="dv">16</span>)</a>
<a class="sourceLine" id="cb105-6" title="6">yhat1 &lt;-<span class="st"> </span>L1<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>L1<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>a</a>
<a class="sourceLine" id="cb105-7" title="7"><span class="kw">lines</span>(a, yhat1, <span class="dt">lwd=</span><span class="dv">2</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb106-1" title="1">L2 &lt;-<span class="st"> </span><span class="kw">lm</span>(magnetic <span class="op">~</span><span class="st"> </span>chemical <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(chemical<span class="op">^</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb106-2" title="2"><span class="kw">plot</span>(chemical, magnetic, <span class="dt">main=</span><span class="st">&quot;Quadratic&quot;</span>, <span class="dt">pch=</span><span class="dv">16</span>)</a>
<a class="sourceLine" id="cb106-3" title="3">yhat2 &lt;-<span class="st"> </span>L2<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>L2<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>a <span class="op">+</span><span class="st"> </span>L2<span class="op">$</span>coef[<span class="dv">3</span>] <span class="op">*</span><span class="st"> </span>a<span class="op">^</span><span class="dv">2</span></a>
<a class="sourceLine" id="cb106-4" title="4"><span class="kw">lines</span>(a, yhat2, <span class="dt">lwd=</span><span class="dv">2</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb107-1" title="1">L3 &lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="kw">log</span>(magnetic) <span class="op">~</span><span class="st"> </span>chemical)</a>
<a class="sourceLine" id="cb107-2" title="2"><span class="kw">plot</span>(chemical, magnetic, <span class="dt">main=</span><span class="st">&quot;Exponential&quot;</span>, <span class="dt">pch=</span><span class="dv">16</span>)</a>
<a class="sourceLine" id="cb107-3" title="3">logyhat3 &lt;-<span class="st"> </span>L3<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>L3<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>a</a>
<a class="sourceLine" id="cb107-4" title="4">yhat3 &lt;-<span class="st"> </span><span class="kw">exp</span>(logyhat3)</a>
<a class="sourceLine" id="cb107-5" title="5"><span class="kw">lines</span>(a, yhat3, <span class="dt">lwd=</span><span class="dv">2</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb108-1" title="1">L4 &lt;-<span class="st"> </span><span class="kw">lm</span>(magnetic <span class="op">~</span><span class="st"> </span>chemical <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(chemical<span class="op">^</span><span class="dv">2</span>) <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(chemical<span class="op">^</span><span class="dv">3</span>))</a>
<a class="sourceLine" id="cb108-2" title="2"><span class="kw">plot</span>(chemical, magnetic, <span class="dt">main=</span><span class="st">&quot;Cubic polynomial&quot;</span>, <span class="dt">pch=</span><span class="dv">16</span>)</a>
<a class="sourceLine" id="cb108-3" title="3">yhat4 &lt;-<span class="st"> </span>L4<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>L4<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>a <span class="op">+</span><span class="st"> </span>L4<span class="op">$</span>coef[<span class="dv">3</span>] <span class="op">*</span><span class="st"> </span>a<span class="op">^</span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span>L4<span class="op">$</span>coef[<span class="dv">4</span>] <span class="op">*</span><span class="st"> </span>a<span class="op">^</span><span class="dv">3</span></a>
<a class="sourceLine" id="cb108-4" title="4"><span class="kw">lines</span>(a, yhat4, <span class="dt">lwd=</span><span class="dv">2</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb109-1" title="1"><span class="co">## Cross validation</span></a>
<a class="sourceLine" id="cb109-2" title="2">n &lt;-<span class="st"> </span><span class="kw">length</span>(magnetic) <span class="co">#in DAAG ironslag</span></a>
<a class="sourceLine" id="cb109-3" title="3">e1 &lt;-<span class="st"> </span>e2 &lt;-<span class="st"> </span>e3 &lt;-<span class="st"> </span>e4 &lt;-<span class="st"> </span><span class="kw">numeric</span>(n)</a>
<a class="sourceLine" id="cb109-4" title="4"><span class="co"># for n-fold cross validation</span></a>
<a class="sourceLine" id="cb109-5" title="5"><span class="co"># fit models on leave-one-out samples</span></a>
<a class="sourceLine" id="cb109-6" title="6"><span class="cf">for</span> (k <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n) {</a>
<a class="sourceLine" id="cb109-7" title="7">  y &lt;-<span class="st"> </span>magnetic[<span class="op">-</span>k]</a>
<a class="sourceLine" id="cb109-8" title="8">  x &lt;-<span class="st"> </span>chemical[<span class="op">-</span>k]</a>
<a class="sourceLine" id="cb109-9" title="9">J1 &lt;-<span class="st"> </span><span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span>x)</a>
<a class="sourceLine" id="cb109-10" title="10">yhat1 &lt;-<span class="st"> </span>J1<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J1<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>chemical[k]</a>
<a class="sourceLine" id="cb109-11" title="11">e1[k] &lt;-<span class="st"> </span>magnetic[k] <span class="op">-</span><span class="st"> </span>yhat1</a>
<a class="sourceLine" id="cb109-12" title="12"></a>
<a class="sourceLine" id="cb109-13" title="13">J2 &lt;-<span class="st"> </span><span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span>x <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(x<span class="op">^</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb109-14" title="14">yhat2 &lt;-<span class="st"> </span>J2<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J2<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>chemical[k] <span class="op">+</span></a>
<a class="sourceLine" id="cb109-15" title="15">J2<span class="op">$</span>coef[<span class="dv">3</span>] <span class="op">*</span><span class="st"> </span>chemical[k]<span class="op">^</span><span class="dv">2</span></a>
<a class="sourceLine" id="cb109-16" title="16">e2[k] &lt;-<span class="st"> </span>magnetic[k] <span class="op">-</span><span class="st"> </span>yhat2</a>
<a class="sourceLine" id="cb109-17" title="17"></a>
<a class="sourceLine" id="cb109-18" title="18">J3 &lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="kw">log</span>(y) <span class="op">~</span><span class="st"> </span>x)</a>
<a class="sourceLine" id="cb109-19" title="19">logyhat3 &lt;-<span class="st"> </span>J3<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J3<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>chemical[k]</a>
<a class="sourceLine" id="cb109-20" title="20">yhat3 &lt;-<span class="st"> </span><span class="kw">exp</span>(logyhat3)</a>
<a class="sourceLine" id="cb109-21" title="21">e3[k] &lt;-<span class="st"> </span>magnetic[k] <span class="op">-</span><span class="st"> </span>yhat3</a>
<a class="sourceLine" id="cb109-22" title="22"></a>
<a class="sourceLine" id="cb109-23" title="23">J4 &lt;-<span class="st"> </span><span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span>x <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(x<span class="op">^</span><span class="dv">2</span>) <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(x<span class="op">^</span><span class="dv">3</span>))</a>
<a class="sourceLine" id="cb109-24" title="24">yhat4 &lt;-<span class="st"> </span>J4<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J4<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>chemical[k] <span class="op">+</span><span class="st"> </span>J4<span class="op">$</span>coef[<span class="dv">3</span>] <span class="op">*</span><span class="st"> </span>chemical[k]<span class="op">^</span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span>J4<span class="op">$</span>coef[<span class="dv">4</span>] <span class="op">*</span><span class="st"> </span>chemical[k]<span class="op">^</span><span class="dv">3</span></a>
<a class="sourceLine" id="cb109-25" title="25">e4[k] &lt;-<span class="st"> </span>magnetic[k] <span class="op">-</span><span class="st"> </span>yhat4</a>
<a class="sourceLine" id="cb109-26" title="26">}</a>
<a class="sourceLine" id="cb109-27" title="27"><span class="kw">c</span>(<span class="kw">mean</span>(e1<span class="op">^</span><span class="dv">2</span>), <span class="kw">mean</span>(e2<span class="op">^</span><span class="dv">2</span>), <span class="kw">mean</span>(e3<span class="op">^</span><span class="dv">2</span>), <span class="kw">mean</span>(e4<span class="op">^</span><span class="dv">2</span>))</a></code></pre></div>
<pre><code>## [1] 19.55644 17.85248 18.44188 18.17756</code></pre>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb111-1" title="1"><span class="kw">library</span>(kableExtra)</a>
<a class="sourceLine" id="cb111-2" title="2">knitr<span class="op">::</span><span class="kw">kable</span>(<span class="kw">cbind</span>(<span class="kw">mean</span>(e1<span class="op">^</span><span class="dv">2</span>), <span class="kw">mean</span>(e2<span class="op">^</span><span class="dv">2</span>), <span class="kw">mean</span>(e3<span class="op">^</span><span class="dv">2</span>), <span class="kw">mean</span>(e4<span class="op">^</span><span class="dv">2</span>)),<span class="dt">formate =</span> <span class="st">&quot;html&quot;</span>,<span class="dt">col.names =</span> <span class="kw">c</span>(<span class="st">&quot;mean(e1^2)&quot;</span>, <span class="st">&quot;mean(e2^2)&quot;</span>, <span class="st">&quot;mean(e3^2)&quot;</span>, <span class="st">&quot;mean(e4^2)&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">kable_styling</span>(<span class="dt">position =</span> <span class="st">&quot;center&quot;</span>)</a></code></pre></div>
<table class="table" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:right;">
mean(e1^2)
</th>
<th style="text-align:right;">
mean(e2^2)
</th>
<th style="text-align:right;">
mean(e3^2)
</th>
<th style="text-align:right;">
mean(e4^2)
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
19.55644
</td>
<td style="text-align:right;">
17.85248
</td>
<td style="text-align:right;">
18.44188
</td>
<td style="text-align:right;">
18.17756
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb112-1" title="1"><span class="co">## the values of Adjusted R-squared</span></a>
<a class="sourceLine" id="cb112-2" title="2">knitr<span class="op">::</span><span class="kw">kable</span>(<span class="kw">cbind</span>(<span class="kw">summary</span>(<span class="kw">lm</span>(L1))<span class="op">$</span>adj.r.squared,<span class="kw">summary</span>(<span class="kw">lm</span>(L2))<span class="op">$</span>adj.r.squared,<span class="kw">summary</span>(<span class="kw">lm</span>(L3))<span class="op">$</span>adj.r.squared,<span class="kw">summary</span>(<span class="kw">lm</span>(L4))<span class="op">$</span>adj.r.squared),<span class="dt">formate =</span> <span class="st">&quot;html&quot;</span>,<span class="dt">col.names =</span> <span class="kw">c</span>(<span class="st">&quot;L1 adj-R^2&quot;</span>,<span class="st">&quot;L2 adj-R^2&quot;</span>,<span class="st">&quot;L3 adj-R^2&quot;</span>,<span class="st">&quot;L4 adj-R^2&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">kable_styling</span>(<span class="dt">position =</span> <span class="st">&quot;center&quot;</span>)</a></code></pre></div>
<table class="table" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:right;">
L1 adj-R^2
</th>
<th style="text-align:right;">
L2 adj-R^2
</th>
<th style="text-align:right;">
L3 adj-R^2
</th>
<th style="text-align:right;">
L4 adj-R^2
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
0.5281545
</td>
<td style="text-align:right;">
0.5768151
</td>
<td style="text-align:right;">
0.5280556
</td>
<td style="text-align:right;">
0.5740396
</td>
</tr>
</tbody>
</table>
<p><strong>Conclusion:</strong> From the analysis, we can find the Quatradic model should be selceted by the cross validation procedure. Because 17.85248 is the smallest among the four values. But if according to the maximum adjusted <span class="math inline">\(R^{2}\)</span>,the Quatradic model should be selected.</p>
</div>
</div>
<div id="homework-8" class="section level1">
<h1>Homework 8</h1>
<div id="question-3" class="section level2">
<h2>Question</h2>
<p>The Count 5 test for equal variances in Section 6.4 is based on the maximum number of extreme points. Example 6.15 shows that the Count 5 criterion is not applicable for unequal sample sizes. Implement a permutation test for equal variance based on the maximum number of extreme points that applies when sample sizes are not necessarily equal.</p>
</div>
<div id="answer-10" class="section level2">
<h2>Answer</h2>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb113-1" title="1"><span class="kw">set.seed</span>(<span class="dv">123</span>)</a>
<a class="sourceLine" id="cb113-2" title="2">n1 &lt;-<span class="st"> </span><span class="dv">30</span>;n2 &lt;-<span class="st"> </span><span class="dv">50</span></a>
<a class="sourceLine" id="cb113-3" title="3">mu1 &lt;-<span class="st"> </span>mu2 &lt;-<span class="st"> </span><span class="dv">0</span>;sigma1 &lt;-<span class="st"> </span>sigma2 &lt;-<span class="st"> </span><span class="dv">1</span>;m &lt;-<span class="st"> </span><span class="dv">10000</span></a>
<a class="sourceLine" id="cb113-4" title="4">x &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n1, mu1, sigma1)</a>
<a class="sourceLine" id="cb113-5" title="5">y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n2, mu2, sigma2)</a>
<a class="sourceLine" id="cb113-6" title="6"></a>
<a class="sourceLine" id="cb113-7" title="7">m1 &lt;-<span class="kw">log</span>(.<span class="dv">025</span>) <span class="op">/</span><span class="st"> </span><span class="kw">log</span>(n1 <span class="op">/</span><span class="st"> </span>(n1 <span class="op">+</span><span class="st"> </span>n2))</a>
<a class="sourceLine" id="cb113-8" title="8">m2 &lt;-<span class="kw">log</span>(.<span class="dv">025</span>) <span class="op">/</span><span class="st"> </span><span class="kw">log</span>(n2 <span class="op">/</span><span class="st"> </span>(n1 <span class="op">+</span><span class="st"> </span>n2))</a>
<a class="sourceLine" id="cb113-9" title="9">count5test &lt;-<span class="st"> </span><span class="cf">function</span>(x, y) {</a>
<a class="sourceLine" id="cb113-10" title="10">X &lt;-<span class="st"> </span>x <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(x)</a>
<a class="sourceLine" id="cb113-11" title="11">Y &lt;-<span class="st"> </span>y <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(y)</a>
<a class="sourceLine" id="cb113-12" title="12">outx &lt;-<span class="st"> </span><span class="kw">sum</span>(X <span class="op">&gt;</span><span class="st"> </span><span class="kw">max</span>(Y)) <span class="op">+</span><span class="st"> </span><span class="kw">sum</span>(X <span class="op">&lt;</span><span class="st"> </span><span class="kw">min</span>(Y))</a>
<a class="sourceLine" id="cb113-13" title="13">outy &lt;-<span class="st"> </span><span class="kw">sum</span>(Y <span class="op">&gt;</span><span class="st"> </span><span class="kw">max</span>(X)) <span class="op">+</span><span class="st"> </span><span class="kw">sum</span>(Y <span class="op">&lt;</span><span class="st"> </span><span class="kw">min</span>(X))</a>
<a class="sourceLine" id="cb113-14" title="14"><span class="kw">return</span>(<span class="kw">as.integer</span>((outx <span class="op">&gt;</span><span class="st"> </span><span class="dv">4</span>) <span class="op">|</span><span class="st"> </span>(outy <span class="op">&gt;</span><span class="st"> </span><span class="dv">7</span>)))</a>
<a class="sourceLine" id="cb113-15" title="15">}</a>
<a class="sourceLine" id="cb113-16" title="16"></a>
<a class="sourceLine" id="cb113-17" title="17">R &lt;-<span class="st"> </span><span class="dv">10000</span></a>
<a class="sourceLine" id="cb113-18" title="18">z &lt;-<span class="st"> </span><span class="kw">c</span>(x,y)</a>
<a class="sourceLine" id="cb113-19" title="19">K &lt;-<span class="st"> </span>n1 <span class="op">+</span><span class="st"> </span>n2</a>
<a class="sourceLine" id="cb113-20" title="20">reps &lt;-<span class="st"> </span><span class="kw">numeric</span>(R)</a>
<a class="sourceLine" id="cb113-21" title="21">t0 &lt;-<span class="st"> </span><span class="kw">count5test</span>(x,y)</a>
<a class="sourceLine" id="cb113-22" title="22"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>R) {</a>
<a class="sourceLine" id="cb113-23" title="23">  k &lt;-<span class="st"> </span><span class="kw">sample</span>(K, <span class="dt">size =</span> n1, <span class="dt">replace =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb113-24" title="24">  x1 &lt;-<span class="st"> </span>z[k];y1 &lt;-<span class="st"> </span>z[<span class="op">-</span>k]</a>
<a class="sourceLine" id="cb113-25" title="25">  X &lt;-<span class="st"> </span>x1 <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(x1); Y &lt;-<span class="st"> </span>y1 <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(y1)</a>
<a class="sourceLine" id="cb113-26" title="26">  reps[i] &lt;-<span class="st"> </span><span class="kw">count5test</span>(x1, y1)</a>
<a class="sourceLine" id="cb113-27" title="27">}</a>
<a class="sourceLine" id="cb113-28" title="28"></a>
<a class="sourceLine" id="cb113-29" title="29">alphahat &lt;-<span class="st"> </span><span class="kw">mean</span>(<span class="kw">c</span>(t0, reps) <span class="op">&gt;</span><span class="st"> </span>t0)</a>
<a class="sourceLine" id="cb113-30" title="30"><span class="kw">print</span>(alphahat)</a></code></pre></div>
<pre><code>## [1] 0.06209379</code></pre>
</div>
<div id="question-4" class="section level2">
<h2>Question</h2>
<p>Power comparison (distance correlation test versus ball covariance test)</p>
<p>Model 1: <span class="math display">\[Y=X / 4+e\]</span> Model 2: <span class="math display">\[Y=X / 4 \times e\]</span> <span class="math inline">\(X \sim N\left(0_{2}, l_{2}\right), e \sim N\left(0_{2}, l_{2}\right)\)</span>,<span class="math inline">\(X\)</span> and <span class="math inline">\(e\)</span> are independent.</p>
</div>
<div id="answer-11" class="section level2">
<h2>Answer</h2>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb115-1" title="1"><span class="co"># functions</span></a>
<a class="sourceLine" id="cb115-2" title="2">dCov &lt;-<span class="st"> </span><span class="cf">function</span>(x, y) {</a>
<a class="sourceLine" id="cb115-3" title="3">  x &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(x); y &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(y)</a>
<a class="sourceLine" id="cb115-4" title="4">  n &lt;-<span class="st"> </span><span class="kw">nrow</span>(x); m &lt;-<span class="st"> </span><span class="kw">nrow</span>(y)</a>
<a class="sourceLine" id="cb115-5" title="5">  <span class="cf">if</span> (n <span class="op">!=</span><span class="st"> </span>m <span class="op">||</span><span class="st"> </span>n <span class="op">&lt;</span><span class="st"> </span><span class="dv">2</span>) <span class="kw">stop</span>(<span class="st">&quot;Sample sizes must agree&quot;</span>)</a>
<a class="sourceLine" id="cb115-6" title="6">  <span class="cf">if</span> (<span class="op">!</span><span class="st"> </span>(<span class="kw">all</span>(<span class="kw">is.finite</span>(<span class="kw">c</span>(x, y)))))</a>
<a class="sourceLine" id="cb115-7" title="7">  <span class="kw">stop</span>(<span class="st">&quot;Data contains missing or infinite values&quot;</span>)</a>
<a class="sourceLine" id="cb115-8" title="8">  Akl &lt;-<span class="st"> </span><span class="cf">function</span>(x) {</a>
<a class="sourceLine" id="cb115-9" title="9">  d &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(<span class="kw">dist</span>(x))</a>
<a class="sourceLine" id="cb115-10" title="10">  m &lt;-<span class="st"> </span><span class="kw">rowMeans</span>(d); M &lt;-<span class="st"> </span><span class="kw">mean</span>(d)</a>
<a class="sourceLine" id="cb115-11" title="11">  a &lt;-<span class="st"> </span><span class="kw">sweep</span>(d, <span class="dv">1</span>, m); b &lt;-<span class="st"> </span><span class="kw">sweep</span>(a, <span class="dv">2</span>, m)</a>
<a class="sourceLine" id="cb115-12" title="12">  b <span class="op">+</span><span class="st"> </span>M</a>
<a class="sourceLine" id="cb115-13" title="13">  }</a>
<a class="sourceLine" id="cb115-14" title="14">A&lt;-<span class="st"> </span><span class="kw">Akl</span>(x); B &lt;-<span class="st"> </span><span class="kw">Akl</span>(y)</a>
<a class="sourceLine" id="cb115-15" title="15"><span class="kw">sqrt</span>(<span class="kw">mean</span>(A <span class="op">*</span><span class="st"> </span>B))</a>
<a class="sourceLine" id="cb115-16" title="16">}</a>
<a class="sourceLine" id="cb115-17" title="17"></a>
<a class="sourceLine" id="cb115-18" title="18">ndCov2 &lt;-<span class="st"> </span><span class="cf">function</span>(z, ix, dims) {</a>
<a class="sourceLine" id="cb115-19" title="19">p &lt;-<span class="st"> </span>dims[<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb115-20" title="20">q &lt;-<span class="st"> </span>dims[<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb115-21" title="21">d &lt;-<span class="st"> </span>p <span class="op">+</span><span class="st"> </span>q</a>
<a class="sourceLine" id="cb115-22" title="22">x &lt;-<span class="st"> </span>z[ , <span class="dv">1</span><span class="op">:</span>p] <span class="co">#leave x as is</span></a>
<a class="sourceLine" id="cb115-23" title="23">y &lt;-<span class="st"> </span>z[ix, <span class="op">-</span>(<span class="dv">1</span><span class="op">:</span>p)] <span class="co">#permute rows of y</span></a>
<a class="sourceLine" id="cb115-24" title="24"><span class="kw">return</span>(<span class="kw">nrow</span>(z) <span class="op">*</span><span class="st"> </span><span class="kw">dCov</span>(x, y)<span class="op">^</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb115-25" title="25">}</a>
<a class="sourceLine" id="cb115-26" title="26"></a>
<a class="sourceLine" id="cb115-27" title="27"><span class="kw">library</span>(Ball)</a>
<a class="sourceLine" id="cb115-28" title="28"><span class="kw">library</span>(mvtnorm)</a>
<a class="sourceLine" id="cb115-29" title="29"><span class="kw">library</span>(boot)</a>
<a class="sourceLine" id="cb115-30" title="30">n&lt;-<span class="kw">seq</span>(<span class="dt">from=</span><span class="dv">10</span>,<span class="dt">to=</span><span class="dv">100</span>,<span class="dt">by=</span><span class="dv">10</span>)</a>
<a class="sourceLine" id="cb115-31" title="31">k&lt;-<span class="dv">100</span></a>
<a class="sourceLine" id="cb115-32" title="32">alpha&lt;-<span class="fl">0.05</span></a>
<a class="sourceLine" id="cb115-33" title="33">pow_dCor_Model1&lt;-pow_ball_Model1&lt;-pow_dCor_Model2&lt;-pow_ball_Model2&lt;-<span class="kw">numeric</span>(<span class="kw">length</span>(n))</a>
<a class="sourceLine" id="cb115-34" title="34"><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(n)) {</a>
<a class="sourceLine" id="cb115-35" title="35"></a>
<a class="sourceLine" id="cb115-36" title="36">  <span class="co">#storage of temp data</span></a>
<a class="sourceLine" id="cb115-37" title="37">  p_ball1&lt;-<span class="kw">numeric</span>(k)</a>
<a class="sourceLine" id="cb115-38" title="38">  dcor1&lt;-<span class="kw">numeric</span>(k)</a>
<a class="sourceLine" id="cb115-39" title="39">  p_ball2&lt;-<span class="kw">numeric</span>(k)</a>
<a class="sourceLine" id="cb115-40" title="40">  dcor2&lt;-<span class="kw">numeric</span>(k)</a>
<a class="sourceLine" id="cb115-41" title="41">  dcor1&lt;-dcor2&lt;-p_ball1&lt;-p_ball2&lt;-<span class="kw">numeric</span>(k)</a>
<a class="sourceLine" id="cb115-42" title="42">  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>k) {</a>
<a class="sourceLine" id="cb115-43" title="43">    <span class="kw">set.seed</span>(i)</a>
<a class="sourceLine" id="cb115-44" title="44">    <span class="co"># the function &quot;rmvnorm&quot; is used to </span></a>
<a class="sourceLine" id="cb115-45" title="45">    <span class="co"># generate the multidimensional normal data</span></a>
<a class="sourceLine" id="cb115-46" title="46">    X&lt;-<span class="kw">rmvnorm</span>(n[j],<span class="kw">rep</span>(<span class="dv">0</span>,<span class="dv">2</span>),<span class="kw">diag</span>(<span class="dv">1</span>,<span class="dv">2</span>))</a>
<a class="sourceLine" id="cb115-47" title="47">    err&lt;-<span class="kw">rmvnorm</span>(n[j],<span class="kw">rep</span>(<span class="dv">0</span>,<span class="dv">2</span>),<span class="kw">diag</span>(<span class="dv">1</span>,<span class="dv">2</span>))</a>
<a class="sourceLine" id="cb115-48" title="48">    Y1&lt;-(X<span class="op">/</span><span class="dv">4</span>)<span class="op">+</span>err</a>
<a class="sourceLine" id="cb115-49" title="49">    Y2&lt;-(X<span class="op">/</span><span class="dv">4</span>)<span class="op">*</span>err</a>
<a class="sourceLine" id="cb115-50" title="50">    Z1&lt;-<span class="kw">cbind</span>(X,Y1)</a>
<a class="sourceLine" id="cb115-51" title="51">    Z2&lt;-<span class="kw">cbind</span>(X,Y2)</a>
<a class="sourceLine" id="cb115-52" title="52">    t1&lt;-<span class="kw">bcov.test</span>(X,Y2,<span class="dt">R=</span><span class="dv">99</span>)</a>
<a class="sourceLine" id="cb115-53" title="53">    p_ball1[i]&lt;-t1<span class="op">$</span>p.value</a>
<a class="sourceLine" id="cb115-54" title="54">    boot.obj1&lt;-<span class="kw">boot</span>(<span class="dt">data=</span>Z1,<span class="dt">statistic=</span>ndCov2,<span class="dt">R=</span><span class="dv">99</span>,<span class="dt">sim=</span><span class="st">&quot;permutation&quot;</span>,<span class="dt">dims=</span><span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</a>
<a class="sourceLine" id="cb115-55" title="55">    temp1&lt;-<span class="kw">c</span>(boot.obj1<span class="op">$</span>t0, boot.obj1<span class="op">$</span>t)</a>
<a class="sourceLine" id="cb115-56" title="56">    dcor1[i]&lt;-<span class="kw">mean</span>(temp1<span class="op">&gt;=</span>temp1[<span class="dv">1</span>])</a>
<a class="sourceLine" id="cb115-57" title="57">    </a>
<a class="sourceLine" id="cb115-58" title="58">    t2&lt;-<span class="kw">bcov.test</span>(X,Y2,<span class="dt">R=</span><span class="dv">99</span>)</a>
<a class="sourceLine" id="cb115-59" title="59">    p_ball2[i]&lt;-t2<span class="op">$</span>p.value</a>
<a class="sourceLine" id="cb115-60" title="60">    boot.obj2&lt;-<span class="kw">boot</span>(<span class="dt">data=</span>Z2,<span class="dt">statistic=</span>ndCov2,<span class="dt">R=</span><span class="dv">99</span>,<span class="dt">sim=</span><span class="st">&quot;permutation&quot;</span>,<span class="dt">dims=</span><span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</a>
<a class="sourceLine" id="cb115-61" title="61">    temp2&lt;-<span class="kw">c</span>(boot.obj2<span class="op">$</span>t0, boot.obj2<span class="op">$</span>t)</a>
<a class="sourceLine" id="cb115-62" title="62">    dcor2[i]&lt;-<span class="kw">mean</span>(temp2<span class="op">&gt;=</span>temp2[<span class="dv">1</span>])</a>
<a class="sourceLine" id="cb115-63" title="63">    }</a>
<a class="sourceLine" id="cb115-64" title="64">  pow_dCor_Model1[j]&lt;-<span class="kw">mean</span>(dcor1<span class="op">&lt;</span>alpha)</a>
<a class="sourceLine" id="cb115-65" title="65">  pow_ball_Model1[j]&lt;-<span class="kw">mean</span>(p_ball1<span class="op">&lt;</span>alpha)</a>
<a class="sourceLine" id="cb115-66" title="66">  pow_dCor_Model2[j]&lt;-<span class="kw">mean</span>(dcor2<span class="op">&lt;</span>alpha)</a>
<a class="sourceLine" id="cb115-67" title="67">  pow_ball_Model2[j]&lt;-<span class="kw">mean</span>(p_ball2<span class="op">&lt;</span>alpha)  </a>
<a class="sourceLine" id="cb115-68" title="68">}</a>
<a class="sourceLine" id="cb115-69" title="69">dat&lt;-<span class="kw">data.frame</span>(pow_dCor_Model1,pow_ball_Model1,pow_dCor_Model2,pow_ball_Model2)</a>
<a class="sourceLine" id="cb115-70" title="70"><span class="co"># the red one is distance correlation test and the blue one is ballcovariance test</span></a>
<a class="sourceLine" id="cb115-71" title="71"><span class="kw">library</span>(ggplot2)</a>
<a class="sourceLine" id="cb115-72" title="72"><span class="kw">ggplot</span>(dat,<span class="kw">aes</span>(n))<span class="op">+</span><span class="kw">geom_point</span>(<span class="dt">y=</span>pow_dCor_Model1,<span class="dt">fill=</span><span class="st">&quot;white&quot;</span>)<span class="op">+</span><span class="kw">geom_line</span>(<span class="dt">y=</span>pow_dCor_Model1,<span class="dt">colour=</span><span class="st">&quot;purple&quot;</span>)<span class="op">+</span><span class="kw">geom_point</span>(<span class="dt">y=</span>pow_ball_Model1,<span class="dt">fill=</span><span class="st">&quot;white&quot;</span>)<span class="op">+</span><span class="kw">geom_line</span>(<span class="dt">y=</span>pow_ball_Model1,<span class="dt">colour=</span><span class="st">&quot;green&quot;</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb116"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb116-1" title="1"><span class="kw">ggplot</span>(dat,<span class="kw">aes</span>(n))<span class="op">+</span><span class="kw">geom_point</span>(<span class="dt">y=</span>pow_dCor_Model2,<span class="dt">fill=</span><span class="st">&quot;white&quot;</span>)<span class="op">+</span><span class="kw">geom_line</span>(<span class="dt">y=</span>pow_dCor_Model2,<span class="dt">colour=</span><span class="st">&quot;purple&quot;</span>)<span class="op">+</span><span class="kw">geom_point</span>(<span class="dt">y=</span>pow_ball_Model2,<span class="dt">fill=</span><span class="st">&quot;white&quot;</span>)<span class="op">+</span><span class="kw">geom_line</span>(<span class="dt">y=</span>pow_ball_Model2,<span class="dt">colour=</span><span class="st">&quot;green&quot;</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
<div id="homework-9" class="section level1">
<h1>Homework 9</h1>
<div id="question-5" class="section level2">
<h2>Question</h2>
<p>Implement a random walk Metropolis sampler for generating the standard Laplace distribution (see Exercise 3.2). For the increment, simulate from a normal distribution. Compare the chains generated when different variances are used for the proposal distribution. Also, compute the acceptance rates of each chain.</p>
</div>
<div id="answer-12" class="section level2">
<h2>Answer</h2>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb117-1" title="1"><span class="kw">library</span>(VGAM)</a></code></pre></div>
<pre><code>## 载入需要的程辑包：stats4</code></pre>
<pre><code>## 载入需要的程辑包：splines</code></pre>
<pre><code>## 
## 载入程辑包：&#39;VGAM&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:boot&#39;:
## 
##     logit, simplex</code></pre>
<pre><code>## The following object is masked from &#39;package:bootstrap&#39;:
## 
##     hormone</code></pre>
<div class="sourceCode" id="cb123"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb123-1" title="1"><span class="kw">library</span>(knitr)</a>
<a class="sourceLine" id="cb123-2" title="2"><span class="kw">library</span>(kableExtra)</a>
<a class="sourceLine" id="cb123-3" title="3"><span class="kw">set.seed</span>(<span class="dv">123</span>)</a>
<a class="sourceLine" id="cb123-4" title="4">    rw.Metropolis &lt;-<span class="st"> </span><span class="cf">function</span>(n, sigma, x0, N) {</a>
<a class="sourceLine" id="cb123-5" title="5">        x &lt;-<span class="st"> </span><span class="kw">numeric</span>(N)</a>
<a class="sourceLine" id="cb123-6" title="6">        x[<span class="dv">1</span>] &lt;-<span class="st"> </span>x0</a>
<a class="sourceLine" id="cb123-7" title="7">        u &lt;-<span class="st"> </span><span class="kw">runif</span>(N)</a>
<a class="sourceLine" id="cb123-8" title="8">        k &lt;-<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb123-9" title="9">        <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>N) {</a>
<a class="sourceLine" id="cb123-10" title="10">            y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">1</span>, x[i<span class="dv">-1</span>], sigma)</a>
<a class="sourceLine" id="cb123-11" title="11">                <span class="cf">if</span> (u[i] <span class="op">&lt;=</span><span class="st"> </span>(<span class="kw">dlaplace</span>(y, <span class="dv">0</span>, <span class="dv">1</span>) <span class="op">/</span><span class="st"> </span><span class="kw">dlaplace</span>(x[i<span class="dv">-1</span>], <span class="dv">0</span>, <span class="dv">1</span>)))</a>
<a class="sourceLine" id="cb123-12" title="12">                    x[i] &lt;-<span class="st"> </span>y  </a>
<a class="sourceLine" id="cb123-13" title="13">                <span class="cf">else</span> {</a>
<a class="sourceLine" id="cb123-14" title="14">                    x[i] &lt;-<span class="st"> </span>x[i<span class="dv">-1</span>]</a>
<a class="sourceLine" id="cb123-15" title="15">                    k &lt;-<span class="st"> </span>k <span class="op">+</span><span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb123-16" title="16">                }</a>
<a class="sourceLine" id="cb123-17" title="17">            }</a>
<a class="sourceLine" id="cb123-18" title="18">        <span class="kw">return</span>(<span class="kw">list</span>(<span class="dt">x=</span>x, <span class="dt">k=</span>k))</a>
<a class="sourceLine" id="cb123-19" title="19">    }</a>
<a class="sourceLine" id="cb123-20" title="20"></a>
<a class="sourceLine" id="cb123-21" title="21">    N &lt;-<span class="st"> </span><span class="dv">2000</span></a>
<a class="sourceLine" id="cb123-22" title="22">    sigma &lt;-<span class="st"> </span><span class="kw">c</span>(.<span class="dv">05</span>, <span class="fl">.5</span>, <span class="dv">2</span>,  <span class="dv">16</span>)</a>
<a class="sourceLine" id="cb123-23" title="23"></a>
<a class="sourceLine" id="cb123-24" title="24">    x0 &lt;-<span class="st"> </span><span class="dv">25</span></a>
<a class="sourceLine" id="cb123-25" title="25">    rw1 &lt;-<span class="st"> </span><span class="kw">rw.Metropolis</span>(n, sigma[<span class="dv">1</span>], x0, N)</a>
<a class="sourceLine" id="cb123-26" title="26">    rw2 &lt;-<span class="st"> </span><span class="kw">rw.Metropolis</span>(n, sigma[<span class="dv">2</span>], x0, N)</a>
<a class="sourceLine" id="cb123-27" title="27">    rw3 &lt;-<span class="st"> </span><span class="kw">rw.Metropolis</span>(n, sigma[<span class="dv">3</span>], x0, N)</a>
<a class="sourceLine" id="cb123-28" title="28">    rw4 &lt;-<span class="st"> </span><span class="kw">rw.Metropolis</span>(n, sigma[<span class="dv">4</span>], x0, N)</a>
<a class="sourceLine" id="cb123-29" title="29"></a>
<a class="sourceLine" id="cb123-30" title="30">    <span class="co">#number of candidate points rejected</span></a>
<a class="sourceLine" id="cb123-31" title="31">    no.reject &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">sigma=</span>sigma,<span class="dt">no.reject=</span><span class="kw">c</span>(rw1<span class="op">$</span>k, rw2<span class="op">$</span>k, rw3<span class="op">$</span>k, rw4<span class="op">$</span>k))</a>
<a class="sourceLine" id="cb123-32" title="32">    knitr<span class="op">::</span><span class="kw">kable</span>(no.reject,<span class="dt">format=</span><span class="st">&#39;html&#39;</span>)<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">kable_styling</span>(<span class="dt">position =</span> <span class="st">&quot;center&quot;</span>)</a></code></pre></div>
<table class="table" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:right;">
sigma
</th>
<th style="text-align:right;">
no.reject
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
0.05
</td>
<td style="text-align:right;">
32
</td>
</tr>
<tr>
<td style="text-align:right;">
0.50
</td>
<td style="text-align:right;">
337
</td>
</tr>
<tr>
<td style="text-align:right;">
2.00
</td>
<td style="text-align:right;">
944
</td>
</tr>
<tr>
<td style="text-align:right;">
16.00
</td>
<td style="text-align:right;">
1810
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb124"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb124-1" title="1">    <span class="co">#compute the acceptance rates of each chain</span></a>
<a class="sourceLine" id="cb124-2" title="2">    ar &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span><span class="op">-</span>rw1<span class="op">$</span>k<span class="op">/</span>N, <span class="dv">1</span><span class="op">-</span>rw2<span class="op">$</span>k<span class="op">/</span>N, <span class="dv">1</span><span class="op">-</span>rw3<span class="op">$</span>k<span class="op">/</span>N, <span class="dv">1</span><span class="op">-</span>rw4<span class="op">$</span>k<span class="op">/</span>N)</a>
<a class="sourceLine" id="cb124-3" title="3">    <span class="kw">print</span>(ar)</a></code></pre></div>
<pre><code>## [1] 0.9840 0.8315 0.5280 0.0950</code></pre>
<div class="sourceCode" id="cb126"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb126-1" title="1">    <span class="kw">par</span>(<span class="dt">mar=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>))  <span class="co">#display 4 graphs together</span></a>
<a class="sourceLine" id="cb126-2" title="2">    refline &lt;-<span class="st"> </span><span class="kw">qlaplace</span>(<span class="kw">c</span>(.<span class="dv">025</span>, <span class="fl">.975</span>))</a>
<a class="sourceLine" id="cb126-3" title="3">    rw &lt;-<span class="st"> </span><span class="kw">cbind</span>(rw1<span class="op">$</span>x, rw2<span class="op">$</span>x, rw3<span class="op">$</span>x,  rw4<span class="op">$</span>x)</a>
<a class="sourceLine" id="cb126-4" title="4">    <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>) {</a>
<a class="sourceLine" id="cb126-5" title="5">        <span class="kw">plot</span>(rw[,j], <span class="dt">type=</span><span class="st">&quot;l&quot;</span>,</a>
<a class="sourceLine" id="cb126-6" title="6">             <span class="dt">xlab=</span><span class="kw">bquote</span>(sigma <span class="op">==</span><span class="st"> </span>.(<span class="kw">round</span>(sigma[j],<span class="dv">3</span>))),</a>
<a class="sourceLine" id="cb126-7" title="7">             <span class="dt">ylab=</span><span class="st">&quot;X&quot;</span>, <span class="dt">ylim=</span><span class="kw">range</span>(rw[,j]))</a>
<a class="sourceLine" id="cb126-8" title="8">        <span class="kw">abline</span>(<span class="dt">h=</span>refline)</a>
<a class="sourceLine" id="cb126-9" title="9">    }</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb127-1" title="1">    <span class="kw">par</span>(<span class="dt">mar=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>)) <span class="co">#reset to default</span></a>
<a class="sourceLine" id="cb127-2" title="2">    </a>
<a class="sourceLine" id="cb127-3" title="3">    a &lt;-<span class="st"> </span><span class="kw">c</span>(.<span class="dv">05</span>, <span class="kw">seq</span>(.<span class="dv">1</span>, <span class="fl">.9</span>, <span class="fl">.1</span>), <span class="fl">.95</span>)</a>
<a class="sourceLine" id="cb127-4" title="4">    Q &lt;-<span class="st"> </span><span class="kw">qlaplace</span>(a, <span class="dv">0</span>, <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb127-5" title="5">    rw &lt;-<span class="st"> </span><span class="kw">cbind</span>(rw1<span class="op">$</span>x, rw2<span class="op">$</span>x, rw3<span class="op">$</span>x, rw4<span class="op">$</span>x)</a>
<a class="sourceLine" id="cb127-6" title="6">    mc &lt;-<span class="st"> </span>rw[<span class="dv">501</span><span class="op">:</span>N, ]</a>
<a class="sourceLine" id="cb127-7" title="7">    Qrw &lt;-<span class="st"> </span><span class="kw">apply</span>(mc, <span class="dv">2</span>, <span class="cf">function</span>(x) <span class="kw">quantile</span>(x, a))</a>
<a class="sourceLine" id="cb127-8" title="8">    qq &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="kw">round</span>(<span class="kw">cbind</span>(Q, Qrw), <span class="dv">3</span>))</a>
<a class="sourceLine" id="cb127-9" title="9">    <span class="kw">names</span>(qq) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&#39;True&#39;</span>,<span class="st">&#39;sigma=0.05&#39;</span>,<span class="st">&#39;sigma=0.5&#39;</span>,<span class="st">&#39;sigma=2&#39;</span>,<span class="st">&#39;sigma=16&#39;</span>)</a>
<a class="sourceLine" id="cb127-10" title="10">    knitr<span class="op">::</span><span class="kw">kable</span>(qq,<span class="dt">format=</span><span class="st">&#39;html&#39;</span>)<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">kable_styling</span>(<span class="dt">position =</span> <span class="st">&quot;center&quot;</span>) </a></code></pre></div>
<table class="table" style="margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
True
</th>
<th style="text-align:right;">
sigma=0.05
</th>
<th style="text-align:right;">
sigma=0.5
</th>
<th style="text-align:right;">
sigma=2
</th>
<th style="text-align:right;">
sigma=16
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
5%
</td>
<td style="text-align:right;">
-2.303
</td>
<td style="text-align:right;">
23.781
</td>
<td style="text-align:right;">
-1.314
</td>
<td style="text-align:right;">
-2.186
</td>
<td style="text-align:right;">
-1.970
</td>
</tr>
<tr>
<td style="text-align:left;">
10%
</td>
<td style="text-align:right;">
-1.609
</td>
<td style="text-align:right;">
23.848
</td>
<td style="text-align:right;">
-0.937
</td>
<td style="text-align:right;">
-1.599
</td>
<td style="text-align:right;">
-1.639
</td>
</tr>
<tr>
<td style="text-align:left;">
20%
</td>
<td style="text-align:right;">
-0.916
</td>
<td style="text-align:right;">
24.039
</td>
<td style="text-align:right;">
-0.559
</td>
<td style="text-align:right;">
-0.836
</td>
<td style="text-align:right;">
-0.747
</td>
</tr>
<tr>
<td style="text-align:left;">
30%
</td>
<td style="text-align:right;">
-0.511
</td>
<td style="text-align:right;">
24.305
</td>
<td style="text-align:right;">
-0.295
</td>
<td style="text-align:right;">
-0.384
</td>
<td style="text-align:right;">
-0.255
</td>
</tr>
<tr>
<td style="text-align:left;">
40%
</td>
<td style="text-align:right;">
-0.223
</td>
<td style="text-align:right;">
24.487
</td>
<td style="text-align:right;">
-0.098
</td>
<td style="text-align:right;">
-0.114
</td>
<td style="text-align:right;">
-0.141
</td>
</tr>
<tr>
<td style="text-align:left;">
50%
</td>
<td style="text-align:right;">
0.000
</td>
<td style="text-align:right;">
24.808
</td>
<td style="text-align:right;">
0.070
</td>
<td style="text-align:right;">
0.089
</td>
<td style="text-align:right;">
-0.015
</td>
</tr>
<tr>
<td style="text-align:left;">
60%
</td>
<td style="text-align:right;">
0.223
</td>
<td style="text-align:right;">
25.326
</td>
<td style="text-align:right;">
0.252
</td>
<td style="text-align:right;">
0.279
</td>
<td style="text-align:right;">
0.070
</td>
</tr>
<tr>
<td style="text-align:left;">
70%
</td>
<td style="text-align:right;">
0.511
</td>
<td style="text-align:right;">
25.538
</td>
<td style="text-align:right;">
0.555
</td>
<td style="text-align:right;">
0.502
</td>
<td style="text-align:right;">
0.331
</td>
</tr>
<tr>
<td style="text-align:left;">
80%
</td>
<td style="text-align:right;">
0.916
</td>
<td style="text-align:right;">
25.674
</td>
<td style="text-align:right;">
0.856
</td>
<td style="text-align:right;">
0.938
</td>
<td style="text-align:right;">
0.782
</td>
</tr>
<tr>
<td style="text-align:left;">
90%
</td>
<td style="text-align:right;">
1.609
</td>
<td style="text-align:right;">
25.918
</td>
<td style="text-align:right;">
1.351
</td>
<td style="text-align:right;">
1.582
</td>
<td style="text-align:right;">
1.576
</td>
</tr>
<tr>
<td style="text-align:left;">
95%
</td>
<td style="text-align:right;">
2.303
</td>
<td style="text-align:right;">
26.111
</td>
<td style="text-align:right;">
1.745
</td>
<td style="text-align:right;">
2.387
</td>
<td style="text-align:right;">
2.436
</td>
</tr>
</tbody>
</table>
<p><strong>Conclusion:</strong>From the figure, we can find that the effect is better when sigma = 0.5. From the following quantile comparison, we can see that sigma = 0.5 and sigma = 2 are similar.</p>
</div>
</div>
<div id="homework-10" class="section level1">
<h1>Homework 10</h1>
<div id="question-11.1" class="section level3">
<h3>Question 11.1</h3>
<p>The natural logarithm and exponential functions are inverses of each other, so that mathematically <span class="math inline">\(\log (\exp x)=\exp (\log x)=x\)</span>. Show by example that this property does not hold exactly in computer arithmetic. Does the identity hold with near equality? (See all.equal.)</p>
</div>
<div id="answer-13" class="section level3">
<h3>Answer</h3>
<div class="sourceCode" id="cb128"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb128-1" title="1">x &lt;-<span class="st"> </span><span class="kw">log</span>(<span class="kw">exp</span>(<span class="dv">100</span>))</a>
<a class="sourceLine" id="cb128-2" title="2">y &lt;-<span class="st"> </span><span class="kw">exp</span>(<span class="kw">log</span>(<span class="dv">100</span>))</a>
<a class="sourceLine" id="cb128-3" title="3"><span class="kw">isTRUE</span>(x <span class="op">==</span><span class="st"> </span>y)</a></code></pre></div>
<pre><code>## [1] FALSE</code></pre>
<div class="sourceCode" id="cb130"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb130-1" title="1"><span class="kw">isTRUE</span>(<span class="kw">all.equal</span>(x,y))</a></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb132"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb132-1" title="1"><span class="kw">print</span>(x<span class="op">-</span>y)</a></code></pre></div>
<pre><code>## [1] -4.263256e-14</code></pre>
<p><strong>Conclusion:</strong> From the result, we can find that the first output is “FLSAE”, and the second output is “TRUE”. We can conclude that this property does not hold exactly in computer arithmetic. But this identity may hold with near equality.</p>
</div>
<div id="question-11.5" class="section level3">
<h3>Question 11.5</h3>
<p>Write a function to solve the equation<br />
<span class="math display">\[ \frac{2 \Gamma\left(\frac{k}{2}\right)}{\sqrt{\pi(k-1)} \Gamma\left(\frac{k-1}{2}\right)} \int_{0}^{c_{k-1}}\left(1+\frac{u^{2}}{k-1}\right)^{-k / 2} d u = \frac{2 \Gamma\left(\frac{k+1}{2}\right)}{\sqrt{\pi k} \Gamma\left(\frac{k}{2}\right)} \int_{0}^{c_{k}}\left(1+\frac{u^{2}}{k}\right)^{-(k+1) / 2} d u  \]</span> for a, where <span class="math display">\[c_{k}=\sqrt{\frac{a^{2} k}{k+1-a^{2}}} \]</span> Compare the solutions with the points A(k) in Exercise 11.4.</p>
</div>
<div id="answer-14" class="section level3">
<h3>Answer</h3>
<div class="sourceCode" id="cb134"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb134-1" title="1">f &lt;-<span class="st"> </span><span class="cf">function</span>(a, k) <span class="dv">1</span><span class="op">-</span><span class="kw">pt</span>(<span class="kw">sqrt</span>(a<span class="op">^</span><span class="dv">2</span><span class="op">*</span>k<span class="op">/</span>(k<span class="op">+</span><span class="dv">1</span><span class="op">-</span>a<span class="op">^</span><span class="dv">2</span>)), k)</a>
<a class="sourceLine" id="cb134-2" title="2">k &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">25</span>, <span class="dv">50</span>, <span class="dv">100</span>, <span class="dv">500</span>)</a>
<a class="sourceLine" id="cb134-3" title="3"><span class="cf">for</span> (i <span class="cf">in</span> k) {</a>
<a class="sourceLine" id="cb134-4" title="4">  h &lt;-<span class="st"> </span><span class="cf">function</span>(x) {<span class="kw">f</span>(x, i<span class="dv">-1</span>)<span class="op">-</span><span class="kw">f</span>(x, i)}</a>
<a class="sourceLine" id="cb134-5" title="5">    a &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">0</span>, <span class="kw">sqrt</span>(i), <span class="fl">.1</span>)</a>
<a class="sourceLine" id="cb134-6" title="6">  <span class="kw">plot</span>(a, <span class="kw">h</span>(a), <span class="dt">type =</span> <span class="st">&#39;b&#39;</span>)</a>
<a class="sourceLine" id="cb134-7" title="7">  <span class="kw">abline</span>(<span class="dt">h =</span> <span class="dv">0</span>)</a>
<a class="sourceLine" id="cb134-8" title="8">}</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --></p>
<p>The figures ared plotted when k = 25, 50, 100 and 500. We can conclude that the roots may fall in the interval (1, 2).</p>
<p>In Exercise 11.4, we can solve the equation when k = 25:50, 50, 250, 500. There are the outcomes:</p>
<div class="sourceCode" id="cb135"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb135-1" title="1">f &lt;-<span class="st"> </span><span class="cf">function</span>(a, k) <span class="dv">1</span><span class="op">-</span><span class="kw">pt</span>(<span class="kw">sqrt</span>(a<span class="op">^</span><span class="dv">2</span><span class="op">*</span>k<span class="op">/</span>(k<span class="op">+</span><span class="dv">1</span><span class="op">-</span>a<span class="op">^</span><span class="dv">2</span>)), k)</a>
<a class="sourceLine" id="cb135-2" title="2">k &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">25</span><span class="op">:</span><span class="dv">50</span>, <span class="dv">100</span>, <span class="dv">250</span>, <span class="dv">500</span>)</a>
<a class="sourceLine" id="cb135-3" title="3">Ak &lt;-<span class="st"> </span><span class="kw">numeric</span>(<span class="kw">length</span>(k))</a>
<a class="sourceLine" id="cb135-4" title="4">i &lt;-<span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb135-5" title="5"><span class="cf">for</span> (j <span class="cf">in</span> k) {</a>
<a class="sourceLine" id="cb135-6" title="6">  g &lt;-<span class="st"> </span><span class="cf">function</span>(x) <span class="kw">f</span>(x, j<span class="dv">-1</span>)<span class="op">-</span><span class="kw">f</span>(x, j)</a>
<a class="sourceLine" id="cb135-7" title="7">  Ak[i] &lt;-<span class="st"> </span><span class="kw">uniroot</span>(g, <span class="dt">lower =</span> <span class="dv">1</span>, <span class="dt">upper =</span> <span class="dv">2</span>)<span class="op">$</span>root</a>
<a class="sourceLine" id="cb135-8" title="8">  i &lt;-<span class="st"> </span>i<span class="op">+</span><span class="dv">1</span></a>
<a class="sourceLine" id="cb135-9" title="9">}</a>
<a class="sourceLine" id="cb135-10" title="10">knitr<span class="op">::</span><span class="kw">kable</span>(<span class="kw">cbind</span>(k,Ak))</a></code></pre></div>
<table>
<thead>
<tr>
<th style="text-align:right;">
k
</th>
<th style="text-align:right;">
Ak
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
25
</td>
<td style="text-align:right;">
1.687373
</td>
</tr>
<tr>
<td style="text-align:right;">
26
</td>
<td style="text-align:right;">
1.689040
</td>
</tr>
<tr>
<td style="text-align:right;">
27
</td>
<td style="text-align:right;">
1.690587
</td>
</tr>
<tr>
<td style="text-align:right;">
28
</td>
<td style="text-align:right;">
1.692027
</td>
</tr>
<tr>
<td style="text-align:right;">
29
</td>
<td style="text-align:right;">
1.693370
</td>
</tr>
<tr>
<td style="text-align:right;">
30
</td>
<td style="text-align:right;">
1.694626
</td>
</tr>
<tr>
<td style="text-align:right;">
31
</td>
<td style="text-align:right;">
1.695803
</td>
</tr>
<tr>
<td style="text-align:right;">
32
</td>
<td style="text-align:right;">
1.696908
</td>
</tr>
<tr>
<td style="text-align:right;">
33
</td>
<td style="text-align:right;">
1.697948
</td>
</tr>
<tr>
<td style="text-align:right;">
34
</td>
<td style="text-align:right;">
1.698929
</td>
</tr>
<tr>
<td style="text-align:right;">
35
</td>
<td style="text-align:right;">
1.699854
</td>
</tr>
<tr>
<td style="text-align:right;">
36
</td>
<td style="text-align:right;">
1.700729
</td>
</tr>
<tr>
<td style="text-align:right;">
37
</td>
<td style="text-align:right;">
1.701534
</td>
</tr>
<tr>
<td style="text-align:right;">
38
</td>
<td style="text-align:right;">
1.702320
</td>
</tr>
<tr>
<td style="text-align:right;">
39
</td>
<td style="text-align:right;">
1.703067
</td>
</tr>
<tr>
<td style="text-align:right;">
40
</td>
<td style="text-align:right;">
1.703777
</td>
</tr>
<tr>
<td style="text-align:right;">
41
</td>
<td style="text-align:right;">
1.704453
</td>
</tr>
<tr>
<td style="text-align:right;">
42
</td>
<td style="text-align:right;">
1.705098
</td>
</tr>
<tr>
<td style="text-align:right;">
43
</td>
<td style="text-align:right;">
1.705713
</td>
</tr>
<tr>
<td style="text-align:right;">
44
</td>
<td style="text-align:right;">
1.706301
</td>
</tr>
<tr>
<td style="text-align:right;">
45
</td>
<td style="text-align:right;">
1.706863
</td>
</tr>
<tr>
<td style="text-align:right;">
46
</td>
<td style="text-align:right;">
1.707401
</td>
</tr>
<tr>
<td style="text-align:right;">
47
</td>
<td style="text-align:right;">
1.707917
</td>
</tr>
<tr>
<td style="text-align:right;">
48
</td>
<td style="text-align:right;">
1.708411
</td>
</tr>
<tr>
<td style="text-align:right;">
49
</td>
<td style="text-align:right;">
1.708886
</td>
</tr>
<tr>
<td style="text-align:right;">
50
</td>
<td style="text-align:right;">
1.709342
</td>
</tr>
<tr>
<td style="text-align:right;">
100
</td>
<td style="text-align:right;">
1.720608
</td>
</tr>
<tr>
<td style="text-align:right;">
250
</td>
<td style="text-align:right;">
1.727457
</td>
</tr>
<tr>
<td style="text-align:right;">
500
</td>
<td style="text-align:right;">
1.729756
</td>
</tr>
</tbody>
</table>
<p>In exercise 11.5:</p>
<div class="sourceCode" id="cb136"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb136-1" title="1">f &lt;-<span class="st"> </span><span class="cf">function</span>(k) <span class="dv">2</span><span class="op">/</span><span class="kw">sqrt</span>(pi<span class="op">*</span>k)<span class="op">*</span><span class="kw">exp</span>(<span class="kw">lgamma</span>((k<span class="op">+</span><span class="dv">1</span>)<span class="op">/</span><span class="dv">2</span>)<span class="op">-</span><span class="kw">lgamma</span>(k<span class="op">/</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb136-2" title="2">ck &lt;-<span class="st"> </span><span class="cf">function</span>(a, k) <span class="kw">sqrt</span>(a<span class="op">^</span><span class="dv">2</span><span class="op">*</span>k<span class="op">/</span>(k<span class="op">+</span><span class="dv">1</span><span class="op">-</span>a<span class="op">^</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb136-3" title="3">g &lt;-<span class="st"> </span><span class="cf">function</span>(u, k) (<span class="dv">1</span><span class="op">+</span>u<span class="op">^</span><span class="dv">2</span><span class="op">/</span>k)<span class="op">^</span>(<span class="op">-</span>(k<span class="op">+</span><span class="dv">1</span>)<span class="op">/</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb136-4" title="4">k &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">25</span><span class="op">:</span><span class="dv">50</span>, <span class="dv">100</span>, <span class="dv">250</span>, <span class="dv">500</span>)</a>
<a class="sourceLine" id="cb136-5" title="5">root &lt;-<span class="st"> </span><span class="kw">numeric</span>(<span class="kw">length</span>(k))</a>
<a class="sourceLine" id="cb136-6" title="6">i &lt;-<span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb136-7" title="7"><span class="cf">for</span> (j <span class="cf">in</span> k) {</a>
<a class="sourceLine" id="cb136-8" title="8">  ff &lt;-<span class="st"> </span><span class="cf">function</span>(a) <span class="kw">f</span>(j)<span class="op">*</span><span class="kw">integrate</span>(<span class="cf">function</span>(u) {<span class="kw">g</span>(u, j)}, <span class="dv">0</span>, <span class="kw">ck</span>(a, j))<span class="op">$</span>value <span class="op">-</span><span class="st">       </span><span class="kw">f</span>(j<span class="dv">-1</span>)<span class="op">*</span><span class="kw">integrate</span>(<span class="cf">function</span>(u) {<span class="kw">g</span>(u, j<span class="dv">-1</span>)}, <span class="dv">0</span>, <span class="kw">ck</span>(a, j<span class="dv">-1</span>))<span class="op">$</span>value </a>
<a class="sourceLine" id="cb136-9" title="9">  root[i] &lt;-<span class="st"> </span><span class="kw">uniroot</span>(ff, <span class="dt">lower =</span> <span class="dv">1</span>, <span class="dt">upper =</span> <span class="dv">2</span>)<span class="op">$</span>root</a>
<a class="sourceLine" id="cb136-10" title="10">  i &lt;-<span class="st"> </span>i<span class="op">+</span><span class="dv">1</span></a>
<a class="sourceLine" id="cb136-11" title="11">}</a>
<a class="sourceLine" id="cb136-12" title="12">knitr<span class="op">::</span><span class="kw">kable</span>(<span class="kw">cbind</span>(k, Ak, root))</a></code></pre></div>
<table>
<thead>
<tr>
<th style="text-align:right;">
k
</th>
<th style="text-align:right;">
Ak
</th>
<th style="text-align:right;">
root
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
25
</td>
<td style="text-align:right;">
1.687373
</td>
<td style="text-align:right;">
1.687373
</td>
</tr>
<tr>
<td style="text-align:right;">
26
</td>
<td style="text-align:right;">
1.689040
</td>
<td style="text-align:right;">
1.689040
</td>
</tr>
<tr>
<td style="text-align:right;">
27
</td>
<td style="text-align:right;">
1.690587
</td>
<td style="text-align:right;">
1.690587
</td>
</tr>
<tr>
<td style="text-align:right;">
28
</td>
<td style="text-align:right;">
1.692027
</td>
<td style="text-align:right;">
1.692027
</td>
</tr>
<tr>
<td style="text-align:right;">
29
</td>
<td style="text-align:right;">
1.693370
</td>
<td style="text-align:right;">
1.693370
</td>
</tr>
<tr>
<td style="text-align:right;">
30
</td>
<td style="text-align:right;">
1.694626
</td>
<td style="text-align:right;">
1.694626
</td>
</tr>
<tr>
<td style="text-align:right;">
31
</td>
<td style="text-align:right;">
1.695803
</td>
<td style="text-align:right;">
1.695803
</td>
</tr>
<tr>
<td style="text-align:right;">
32
</td>
<td style="text-align:right;">
1.696908
</td>
<td style="text-align:right;">
1.696908
</td>
</tr>
<tr>
<td style="text-align:right;">
33
</td>
<td style="text-align:right;">
1.697948
</td>
<td style="text-align:right;">
1.697948
</td>
</tr>
<tr>
<td style="text-align:right;">
34
</td>
<td style="text-align:right;">
1.698929
</td>
<td style="text-align:right;">
1.698929
</td>
</tr>
<tr>
<td style="text-align:right;">
35
</td>
<td style="text-align:right;">
1.699854
</td>
<td style="text-align:right;">
1.699854
</td>
</tr>
<tr>
<td style="text-align:right;">
36
</td>
<td style="text-align:right;">
1.700729
</td>
<td style="text-align:right;">
1.700729
</td>
</tr>
<tr>
<td style="text-align:right;">
37
</td>
<td style="text-align:right;">
1.701534
</td>
<td style="text-align:right;">
1.701534
</td>
</tr>
<tr>
<td style="text-align:right;">
38
</td>
<td style="text-align:right;">
1.702320
</td>
<td style="text-align:right;">
1.702320
</td>
</tr>
<tr>
<td style="text-align:right;">
39
</td>
<td style="text-align:right;">
1.703067
</td>
<td style="text-align:right;">
1.703067
</td>
</tr>
<tr>
<td style="text-align:right;">
40
</td>
<td style="text-align:right;">
1.703777
</td>
<td style="text-align:right;">
1.703777
</td>
</tr>
<tr>
<td style="text-align:right;">
41
</td>
<td style="text-align:right;">
1.704453
</td>
<td style="text-align:right;">
1.704453
</td>
</tr>
<tr>
<td style="text-align:right;">
42
</td>
<td style="text-align:right;">
1.705098
</td>
<td style="text-align:right;">
1.705098
</td>
</tr>
<tr>
<td style="text-align:right;">
43
</td>
<td style="text-align:right;">
1.705713
</td>
<td style="text-align:right;">
1.705713
</td>
</tr>
<tr>
<td style="text-align:right;">
44
</td>
<td style="text-align:right;">
1.706301
</td>
<td style="text-align:right;">
1.706301
</td>
</tr>
<tr>
<td style="text-align:right;">
45
</td>
<td style="text-align:right;">
1.706863
</td>
<td style="text-align:right;">
1.706863
</td>
</tr>
<tr>
<td style="text-align:right;">
46
</td>
<td style="text-align:right;">
1.707401
</td>
<td style="text-align:right;">
1.707401
</td>
</tr>
<tr>
<td style="text-align:right;">
47
</td>
<td style="text-align:right;">
1.707917
</td>
<td style="text-align:right;">
1.707917
</td>
</tr>
<tr>
<td style="text-align:right;">
48
</td>
<td style="text-align:right;">
1.708411
</td>
<td style="text-align:right;">
1.708411
</td>
</tr>
<tr>
<td style="text-align:right;">
49
</td>
<td style="text-align:right;">
1.708886
</td>
<td style="text-align:right;">
1.708886
</td>
</tr>
<tr>
<td style="text-align:right;">
50
</td>
<td style="text-align:right;">
1.709342
</td>
<td style="text-align:right;">
1.709342
</td>
</tr>
<tr>
<td style="text-align:right;">
100
</td>
<td style="text-align:right;">
1.720608
</td>
<td style="text-align:right;">
1.720608
</td>
</tr>
<tr>
<td style="text-align:right;">
250
</td>
<td style="text-align:right;">
1.727457
</td>
<td style="text-align:right;">
1.727457
</td>
</tr>
<tr>
<td style="text-align:right;">
500
</td>
<td style="text-align:right;">
1.729756
</td>
<td style="text-align:right;">
1.729756
</td>
</tr>
</tbody>
</table>
<p>The outcomes in ‘Ak’ column are the outcomes in Exercise 11.4 and these in ‘root’ column are the outcomes in Exercise 11.5. We can find from the table that the results are the same. This result is obvious as these two questions are in fact the same.</p>
</div>
<div id="question-3-1" class="section level3">
<h3>Question 3</h3>
<ul>
<li>A-B-O blood type problem
<ul>
<li><p>Let the three alleles be A, B, and O.</p>
<table>
<tbody>
<tr>
<td style="text-align:left;">
<p>Genotype</p>
</td>
<td style="text-align:left;">
<p>AA</p>
</td>
<td style="text-align:left;">
<p>BB</p>
</td>
<td style="text-align:left;">
<p>OO</p>
</td>
<td style="text-align:left;">
<p>AO</p>
</td>
<td style="text-align:left;">
<p>BO</p>
</td>
<td style="text-align:left;">
<p>AB</p>
</td>
<td style="text-align:left;">
<p>Sum</p>
</td>
</tr>
<tr>
<td style="text-align:left;">
<p>Frequency</p>
</td>
<td style="text-align:left;">
<p>p^2</p>
</td>
<td style="text-align:left;">
<p>q^2</p>
</td>
<td style="text-align:left;">
<p>r^2</p>
</td>
<td style="text-align:left;">
<p>2pr</p>
</td>
<td style="text-align:left;">
<p>2qr</p>
</td>
<td style="text-align:left;">
<p>2pq</p>
</td>
<td style="text-align:left;">
<p>1</p>
</td>
</tr>
<tr>
<td style="text-align:left;">
<p>Count</p>
</td>
<td style="text-align:left;">
<p>nAA</p>
</td>
<td style="text-align:left;">
<p>nBB</p>
</td>
<td style="text-align:left;">
<p>nOO</p>
</td>
<td style="text-align:left;">
<p>nAO</p>
</td>
<td style="text-align:left;">
<p>nBO</p>
</td>
<td style="text-align:left;">
<p>nAB</p>
</td>
<td style="text-align:left;">
<p>n</p>
</td>
</tr>
</tbody>
</table></li>
<li><p>Observed data: <span class="math inline">\(n_{A\cdot}=n_{AA}+n_{AO}=28\)</span> (A-type), <span class="math inline">\(n_{B\cdot}=n_{BB}+n_{BO}=24\)</span> (B-type), <span class="math inline">\(n_{OO}=41\)</span> (O-type), <span class="math inline">\(n_{AB}=70\)</span> (AB-type).</p></li>
<li><p>Use EM algorithm to solve MLE of <span class="math inline">\(p\)</span> and <span class="math inline">\(q\)</span> (consider missing data <span class="math inline">\(n_{AA}\)</span> and <span class="math inline">\(n_{BB}\)</span>).</p></li>
<li><p>Record the log-maximum likelihood values in M-steps, are they increasing?</p></li>
</ul></li>
</ul>
</div>
<div id="answer-15" class="section level3">
<h3>Answer</h3>
<div class="sourceCode" id="cb137"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb137-1" title="1">nA &lt;-<span class="st"> </span><span class="dv">28</span>; nB &lt;-<span class="st"> </span><span class="dv">24</span>; nOO &lt;-<span class="st"> </span><span class="dv">41</span>; nAB &lt;-<span class="st"> </span><span class="dv">70</span></a>
<a class="sourceLine" id="cb137-2" title="2"></a>
<a class="sourceLine" id="cb137-3" title="3">theta_<span class="dv">0</span> &lt;-<span class="st"> </span><span class="kw">c</span>(.<span class="dv">1</span>, <span class="fl">.1</span>)</a>
<a class="sourceLine" id="cb137-4" title="4"><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">1000</span>) {</a>
<a class="sourceLine" id="cb137-5" title="5">  E &lt;-<span class="st"> </span><span class="cf">function</span>(theta) {</a>
<a class="sourceLine" id="cb137-6" title="6">    p &lt;-<span class="st"> </span>theta[<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb137-7" title="7">    q &lt;-<span class="st"> </span>theta[<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb137-8" title="8">    r &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">-</span>p<span class="op">-</span>q</a>
<a class="sourceLine" id="cb137-9" title="9">    p0 &lt;-<span class="st"> </span>theta_<span class="dv">0</span>[<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb137-10" title="10">    q0 &lt;-<span class="st"> </span>theta_<span class="dv">0</span>[<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb137-11" title="11">    r0 &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">-</span>p0<span class="op">-</span>q0</a>
<a class="sourceLine" id="cb137-12" title="12">    <span class="kw">return</span>(<span class="dv">2</span><span class="op">*</span>nA<span class="op">*</span>(<span class="kw">log</span>(p)<span class="op">+</span>r0<span class="op">/</span>(p0<span class="op">+</span><span class="dv">2</span><span class="op">*</span>r0)<span class="op">*</span><span class="kw">log</span>(<span class="dv">2</span><span class="op">*</span>r<span class="op">/</span>p))<span class="op">+</span><span class="dv">2</span><span class="op">*</span>nB<span class="op">*</span>(<span class="kw">log</span>(q)<span class="op">+</span>r0<span class="op">/</span>(q0<span class="op">+</span><span class="dv">2</span><span class="op">*</span>r0)<span class="op">*</span><span class="kw">log</span>(<span class="dv">2</span><span class="op">*</span>r<span class="op">/</span>q))<span class="op">+</span><span class="dv">2</span><span class="op">*</span>nOO<span class="op">*</span><span class="kw">log</span>(r)<span class="op">+</span>nAB<span class="op">*</span><span class="kw">log</span>(<span class="dv">2</span><span class="op">*</span>p<span class="op">*</span>q))</a>
<a class="sourceLine" id="cb137-13" title="13">  }</a>
<a class="sourceLine" id="cb137-14" title="14">  Obj &lt;-<span class="st"> </span><span class="cf">function</span>(theta) <span class="op">-</span><span class="kw">E</span>(theta)</a>
<a class="sourceLine" id="cb137-15" title="15">  optim &lt;-<span class="st"> </span><span class="kw">optim</span>(<span class="kw">c</span>(.<span class="dv">1</span>, <span class="fl">.1</span>), Obj)</a>
<a class="sourceLine" id="cb137-16" title="16">  theta_<span class="dv">0</span> &lt;-<span class="st"> </span>optim<span class="op">$</span>par</a>
<a class="sourceLine" id="cb137-17" title="17">}</a>
<a class="sourceLine" id="cb137-18" title="18"><span class="kw">print</span>(theta_<span class="dv">0</span>)</a></code></pre></div>
<pre><code>## [1] 0.3273325 0.3104528</code></pre>
<p>From the result, we obtain the MLE of p and q are 0.3273325 and 0.3104528 respectively according to EM algorithm.</p>
</div>
</div>
<div id="homework-11" class="section level1">
<h1>Homework 11</h1>
<div id="question-3-2" class="section level3">
<h3>Question 3</h3>
<p>Use both for loops and lapply() to fit linear models to the mtcars using the formulas stored in this list:</p>
<p>formulas &lt;- list( mpg ~ disp, mpg ~ I(1 / disp), mpg ~ disp + wt, mpg ~ I(1 / disp) + wt )</p>
</div>
<div id="answer-16" class="section level3">
<h3>Answer</h3>
<div class="sourceCode" id="cb139"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb139-1" title="1">data &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(mtcars)</a>
<a class="sourceLine" id="cb139-2" title="2">mpg &lt;-<span class="st"> </span>data[,<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb139-3" title="3">disp &lt;-<span class="st"> </span>data[,<span class="dv">3</span>]</a>
<a class="sourceLine" id="cb139-4" title="4">wt &lt;-<span class="st"> </span>data[,<span class="dv">6</span>]</a>
<a class="sourceLine" id="cb139-5" title="5"></a>
<a class="sourceLine" id="cb139-6" title="6"><span class="co"># for loops</span></a>
<a class="sourceLine" id="cb139-7" title="7">re &lt;-<span class="st"> </span><span class="kw">list</span>()</a>
<a class="sourceLine" id="cb139-8" title="8">re1 &lt;-<span class="st"> </span>mpg <span class="op">~</span><span class="st"> </span>disp</a>
<a class="sourceLine" id="cb139-9" title="9">re2 &lt;-<span class="st"> </span>mpg <span class="op">~</span><span class="st"> </span><span class="kw">I</span>(<span class="dv">1</span> <span class="op">/</span><span class="st"> </span>disp)</a>
<a class="sourceLine" id="cb139-10" title="10">re3 &lt;-<span class="st"> </span>mpg <span class="op">~</span><span class="st"> </span>disp <span class="op">+</span><span class="st"> </span>wt</a>
<a class="sourceLine" id="cb139-11" title="11">re4 &lt;-<span class="st"> </span>mpg <span class="op">~</span><span class="st"> </span><span class="kw">I</span>(<span class="dv">1</span> <span class="op">/</span><span class="st"> </span>disp) <span class="op">+</span><span class="st"> </span>wt</a>
<a class="sourceLine" id="cb139-12" title="12">h &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;re1&quot;</span>,<span class="st">&quot;re2&quot;</span>,<span class="st">&quot;re3&quot;</span>,<span class="st">&quot;re4&quot;</span>)</a>
<a class="sourceLine" id="cb139-13" title="13"></a>
<a class="sourceLine" id="cb139-14" title="14"><span class="cf">for</span> (i <span class="cf">in</span> h){</a>
<a class="sourceLine" id="cb139-15" title="15">  re[i] &lt;-<span class="st"> </span><span class="kw">lm</span>(i)</a>
<a class="sourceLine" id="cb139-16" title="16">}</a>
<a class="sourceLine" id="cb139-17" title="17">re</a></code></pre></div>
<pre><code>## $re1
## (Intercept)        disp 
## 29.59985476 -0.04121512 
## 
## $re2
## (Intercept)   I(1/disp) 
##    10.75202  1557.67393 
## 
## $re3
## (Intercept)        disp          wt 
## 34.96055404 -0.01772474 -3.35082533 
## 
## $re4
## (Intercept)   I(1/disp)          wt 
##   19.024206 1142.559975   -1.797649</code></pre>
<div class="sourceCode" id="cb141"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb141-1" title="1"><span class="co"># lapply</span></a>
<a class="sourceLine" id="cb141-2" title="2">f &lt;-<span class="st"> </span><span class="kw">list</span>(mpg <span class="op">~</span><span class="st"> </span>disp,</a>
<a class="sourceLine" id="cb141-3" title="3">       mpg <span class="op">~</span><span class="st"> </span><span class="kw">I</span>(<span class="dv">1</span> <span class="op">/</span><span class="st"> </span>disp),</a>
<a class="sourceLine" id="cb141-4" title="4">       mpg <span class="op">~</span><span class="st"> </span>disp <span class="op">+</span><span class="st"> </span>wt,</a>
<a class="sourceLine" id="cb141-5" title="5">       mpg <span class="op">~</span><span class="st"> </span><span class="kw">I</span>(<span class="dv">1</span> <span class="op">/</span><span class="st"> </span>disp) <span class="op">+</span><span class="st"> </span>wt)</a>
<a class="sourceLine" id="cb141-6" title="6"><span class="kw">lapply</span>(f, lm)</a></code></pre></div>
<pre><code>## [[1]]
## 
## Call:
## FUN(formula = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    29.59985     -0.04122  
## 
## 
## [[2]]
## 
## Call:
## FUN(formula = X[[i]])
## 
## Coefficients:
## (Intercept)    I(1/disp)  
##       10.75      1557.67  
## 
## 
## [[3]]
## 
## Call:
## FUN(formula = X[[i]])
## 
## Coefficients:
## (Intercept)         disp           wt  
##    34.96055     -0.01772     -3.35083  
## 
## 
## [[4]]
## 
## Call:
## FUN(formula = X[[i]])
## 
## Coefficients:
## (Intercept)    I(1/disp)           wt  
##      19.024     1142.560       -1.798</code></pre>
</div>
<div id="question-4-1" class="section level3">
<h3>Question 4</h3>
<p>Fit the model mpg ~ disp to each of the bootstrap replicates of mtcars in the list below by using a for loop and lapply(). Can you do it without an anonymous function?</p>
<p>bootstraps &lt;- lapply(1:10, function(i) { rows &lt;- sample(1:nrow(mtcars), rep = TRUE) mtcars[rows, ] })</p>
</div>
<div id="answer-17" class="section level3">
<h3>Answer</h3>
<div class="sourceCode" id="cb143"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb143-1" title="1"><span class="kw">set.seed</span>(<span class="dv">123</span>)</a>
<a class="sourceLine" id="cb143-2" title="2">bootstraps &lt;-<span class="st"> </span><span class="kw">lapply</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>, <span class="cf">function</span>(i) {</a>
<a class="sourceLine" id="cb143-3" title="3">      rows &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(mtcars), <span class="dt">rep =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb143-4" title="4">      mtcars[rows, ]</a>
<a class="sourceLine" id="cb143-5" title="5">      })</a>
<a class="sourceLine" id="cb143-6" title="6"><span class="co"># for loops</span></a>
<a class="sourceLine" id="cb143-7" title="7">g &lt;-<span class="st"> </span><span class="kw">list</span>()</a>
<a class="sourceLine" id="cb143-8" title="8"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">10</span>){</a>
<a class="sourceLine" id="cb143-9" title="9">  g[i] &lt;-<span class="st"> </span><span class="kw">lm</span>(mpg<span class="op">~</span>disp, <span class="dt">data =</span> bootstraps[[i]])</a>
<a class="sourceLine" id="cb143-10" title="10">}</a>
<a class="sourceLine" id="cb143-11" title="11">g</a></code></pre></div>
<pre><code>## [[1]]
## (Intercept)        disp 
## 29.59804025 -0.03797831 
## 
## [[2]]
## (Intercept)        disp 
## 27.38760407 -0.03411317 
## 
## [[3]]
## (Intercept)        disp 
## 30.27666550 -0.04175611 
## 
## [[4]]
## (Intercept)        disp 
## 27.25456701 -0.03270754 
## 
## [[5]]
## (Intercept)        disp 
## 29.07161410 -0.04128939 
## 
## [[6]]
## (Intercept)        disp 
## 28.51715577 -0.03935732 
## 
## [[7]]
## (Intercept)        disp 
##  31.7497532  -0.0464673 
## 
## [[8]]
## (Intercept)        disp 
## 27.47887336 -0.03404925 
## 
## [[9]]
## (Intercept)        disp 
##  29.5774947  -0.0404346 
## 
## [[10]]
## (Intercept)        disp 
## 29.60505274 -0.04017415</code></pre>
<div class="sourceCode" id="cb145"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb145-1" title="1"><span class="co"># lapply</span></a>
<a class="sourceLine" id="cb145-2" title="2"><span class="co">#lapply(1:10, FUN = function(x) lm(mpg~disp, data = bootstraps[[x]]) )</span></a>
<a class="sourceLine" id="cb145-3" title="3"><span class="kw">lapply</span>(bootstraps, lm, <span class="dt">formula =</span> mpg<span class="op">~</span>disp)</a></code></pre></div>
<pre><code>## [[1]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    29.59804     -0.03798  
## 
## 
## [[2]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    27.38760     -0.03411  
## 
## 
## [[3]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    30.27667     -0.04176  
## 
## 
## [[4]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    27.25457     -0.03271  
## 
## 
## [[5]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    29.07161     -0.04129  
## 
## 
## [[6]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    28.51716     -0.03936  
## 
## 
## [[7]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    31.74975     -0.04647  
## 
## 
## [[8]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    27.47887     -0.03405  
## 
## 
## [[9]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    29.57749     -0.04043  
## 
## 
## [[10]]
## 
## Call:
## FUN(formula = ..1, data = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    29.60505     -0.04017</code></pre>
</div>
<div id="question-5-1" class="section level3">
<h3>Question 5</h3>
<p>For each model in the previous two exercises, extract <span class="math inline">\(R^2\)</span> using the function below.</p>
<p>rsq &lt;- function(mod) summary(mod)$r.squared</p>
</div>
<div id="answer-18" class="section level3">
<h3>Answer</h3>
<div class="sourceCode" id="cb147"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb147-1" title="1">rsq &lt;-<span class="st"> </span><span class="cf">function</span>(mod) <span class="kw">summary</span>(mod)<span class="op">$</span>r.squared</a>
<a class="sourceLine" id="cb147-2" title="2"></a>
<a class="sourceLine" id="cb147-3" title="3"><span class="co"># exercise 3</span></a>
<a class="sourceLine" id="cb147-4" title="4">m &lt;-<span class="st"> </span><span class="kw">lapply</span>(f, lm)</a>
<a class="sourceLine" id="cb147-5" title="5"><span class="kw">lapply</span>(m, rsq)</a></code></pre></div>
<pre><code>## [[1]]
## [1] 0.7183433
## 
## [[2]]
## [1] 0.8596865
## 
## [[3]]
## [1] 0.7809306
## 
## [[4]]
## [1] 0.8838038</code></pre>
<div class="sourceCode" id="cb149"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb149-1" title="1"><span class="co"># exercise 4</span></a>
<a class="sourceLine" id="cb149-2" title="2">n &lt;-<span class="st"> </span><span class="kw">lapply</span>(bootstraps, lm, <span class="dt">formula =</span> mpg<span class="op">~</span>disp)</a>
<a class="sourceLine" id="cb149-3" title="3"><span class="kw">lapply</span>(n, rsq)</a></code></pre></div>
<pre><code>## [[1]]
## [1] 0.6497636
## 
## [[2]]
## [1] 0.6820834
## 
## [[3]]
## [1] 0.7530595
## 
## [[4]]
## [1] 0.6101709
## 
## [[5]]
## [1] 0.7226119
## 
## [[6]]
## [1] 0.7533418
## 
## [[7]]
## [1] 0.7311415
## 
## [[8]]
## [1] 0.6293502
## 
## [[9]]
## [1] 0.6554375
## 
## [[10]]
## [1] 0.7238971</code></pre>
</div>
<div id="question-3-3" class="section level3">
<h3>Question 3</h3>
<p>The following code simulates the performance of a t-test for non-normal data. Use sapply() and an anonymous function to extract the <span class="math inline">\(p\)</span>-value from every trial.</p>
<p>trials &lt;- replicate( 100, t.test(rpois(10, 10), rpois(7, 10)), simplify = FALSE )</p>
<p>Extra challenge: get rid of the anonymous function by using [[ directly.</p>
</div>
<div id="answer-19" class="section level3">
<h3>Answer</h3>
<div class="sourceCode" id="cb151"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb151-1" title="1"><span class="kw">set.seed</span>(<span class="dv">1234</span>)</a>
<a class="sourceLine" id="cb151-2" title="2">trials &lt;-<span class="st"> </span><span class="kw">replicate</span>(</a>
<a class="sourceLine" id="cb151-3" title="3">        <span class="dv">100</span>,</a>
<a class="sourceLine" id="cb151-4" title="4">        <span class="kw">t.test</span>(<span class="kw">rpois</span>(<span class="dv">10</span>, <span class="dv">10</span>), <span class="kw">rpois</span>(<span class="dv">7</span>, <span class="dv">10</span>)),</a>
<a class="sourceLine" id="cb151-5" title="5">        <span class="dt">simplify =</span> <span class="ot">FALSE</span></a>
<a class="sourceLine" id="cb151-6" title="6">       )</a>
<a class="sourceLine" id="cb151-7" title="7"></a>
<a class="sourceLine" id="cb151-8" title="8"><span class="co"># sapply</span></a>
<a class="sourceLine" id="cb151-9" title="9">l &lt;-<span class="st"> </span><span class="cf">function</span>(x) x<span class="op">$</span>p.value</a>
<a class="sourceLine" id="cb151-10" title="10"><span class="kw">sapply</span>(trials, l)</a></code></pre></div>
<pre><code>##   [1] 0.92573839 0.38341791 0.21070462 0.41458918 0.26121206 0.72223937
##   [7] 0.29887169 0.95162894 0.26398664 0.62018151 0.51388383 0.94676108
##  [13] 0.05206634 0.94395869 0.90872276 0.91948631 0.66419598 0.29837025
##  [19] 0.29940554 0.83506207 0.45274078 0.90320828 0.79263778 0.45399170
##  [25] 0.38923722 0.69542630 0.26739653 0.38567329 0.31137487 0.36010634
##  [31] 0.39754771 0.72253407 0.42186171 0.12771643 0.23170443 0.68265125
##  [37] 0.71252902 0.12724649 0.75353630 0.94884686 0.87276882 0.41388298
##  [43] 0.25224053 0.84404036 0.16580146 0.42473329 0.82280924 0.71272703
##  [49] 0.30947058 0.92816784 0.27134690 0.62008647 0.49758173 0.02775463
##  [55] 0.78775614 0.26248714 0.77273771 0.68416168 0.08687832 0.04574362
##  [61] 0.44178950 0.36827740 0.64265435 0.47847663 0.10832740 0.75695184
##  [67] 0.61642417 0.01474650 0.18023871 0.42316145 0.38702375 0.27030894
##  [73] 0.92266032 0.75504614 0.65781938 0.34910615 0.22083614 0.53165720
##  [79] 0.14727409 0.50490437 0.42920650 0.71256710 0.72931439 0.90676814
##  [85] 0.85988192 0.87366680 0.91047506 0.99255659 0.15198012 0.09537499
##  [91] 0.37213020 0.96151424 0.97595090 0.30669922 0.42738809 0.75571001
##  [97] 0.15155800 0.06214524 0.29324608 0.83599679</code></pre>
<div class="sourceCode" id="cb153"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb153-1" title="1"><span class="co"># Extra challenge</span></a>
<a class="sourceLine" id="cb153-2" title="2"><span class="kw">sapply</span>(trials, <span class="st">&#39;[[&#39;</span>,<span class="dv">3</span>)</a></code></pre></div>
<pre><code>##   [1] 0.92573839 0.38341791 0.21070462 0.41458918 0.26121206 0.72223937
##   [7] 0.29887169 0.95162894 0.26398664 0.62018151 0.51388383 0.94676108
##  [13] 0.05206634 0.94395869 0.90872276 0.91948631 0.66419598 0.29837025
##  [19] 0.29940554 0.83506207 0.45274078 0.90320828 0.79263778 0.45399170
##  [25] 0.38923722 0.69542630 0.26739653 0.38567329 0.31137487 0.36010634
##  [31] 0.39754771 0.72253407 0.42186171 0.12771643 0.23170443 0.68265125
##  [37] 0.71252902 0.12724649 0.75353630 0.94884686 0.87276882 0.41388298
##  [43] 0.25224053 0.84404036 0.16580146 0.42473329 0.82280924 0.71272703
##  [49] 0.30947058 0.92816784 0.27134690 0.62008647 0.49758173 0.02775463
##  [55] 0.78775614 0.26248714 0.77273771 0.68416168 0.08687832 0.04574362
##  [61] 0.44178950 0.36827740 0.64265435 0.47847663 0.10832740 0.75695184
##  [67] 0.61642417 0.01474650 0.18023871 0.42316145 0.38702375 0.27030894
##  [73] 0.92266032 0.75504614 0.65781938 0.34910615 0.22083614 0.53165720
##  [79] 0.14727409 0.50490437 0.42920650 0.71256710 0.72931439 0.90676814
##  [85] 0.85988192 0.87366680 0.91047506 0.99255659 0.15198012 0.09537499
##  [91] 0.37213020 0.96151424 0.97595090 0.30669922 0.42738809 0.75571001
##  [97] 0.15155800 0.06214524 0.29324608 0.83599679</code></pre>
</div>
<div id="question-7" class="section level3">
<h3>Question 7</h3>
<p>Implement <span class="math inline">\(mcsapply()\)</span>, a multicore version of <span class="math inline">\(sapply()\)</span>. Can you implement <span class="math inline">\(mcvapply()\)</span>, a parallel version of <span class="math inline">\(vapply()\)</span>? Why or why not?</p>
</div>
<div id="answer-20" class="section level3">
<h3>Answer</h3>
<div class="sourceCode" id="cb155"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb155-1" title="1"><span class="co"># mcsapply()</span></a>
<a class="sourceLine" id="cb155-2" title="2"><span class="kw">library</span>(parallel)</a>
<a class="sourceLine" id="cb155-3" title="3">boot_df &lt;-<span class="st"> </span><span class="cf">function</span>(x) x[<span class="kw">sample</span>(<span class="kw">nrow</span>(x), <span class="dt">rep =</span> T), ]</a>
<a class="sourceLine" id="cb155-4" title="4">rsquared &lt;-<span class="st"> </span><span class="cf">function</span>(mod) <span class="kw">summary</span>(mod)<span class="op">$</span>r.squared</a>
<a class="sourceLine" id="cb155-5" title="5">boot_lm &lt;-<span class="st"> </span><span class="cf">function</span>(i) {</a>
<a class="sourceLine" id="cb155-6" title="6">  <span class="kw">rsquared</span>(<span class="kw">lm</span>(mpg <span class="op">~</span><span class="st"> </span>wt <span class="op">+</span><span class="st"> </span>disp, <span class="dt">data =</span> <span class="kw">boot_df</span>(mtcars)))</a>
<a class="sourceLine" id="cb155-7" title="7">}</a>
<a class="sourceLine" id="cb155-8" title="8"><span class="kw">system.time</span>(<span class="kw">sapply</span>(<span class="dv">1</span><span class="op">:</span><span class="fl">1e5</span>, boot_lm))</a>
<a class="sourceLine" id="cb155-9" title="9"><span class="kw">system.time</span>(<span class="kw">unlist</span>(<span class="kw">mclapply</span>(<span class="dv">1</span><span class="op">:</span><span class="fl">1e5</span>, boot_lm, <span class="dt">mc.cores =</span> <span class="dv">4</span>)))</a></code></pre></div>
<p>In Windows, <span class="math inline">\(mclapply()\)</span> fails. We can not find the results. ‘mc.cores’ &gt; 1 is not supported on Windows</p>
</div>
</div>
<div id="homework-12" class="section level1">
<h1>Homework 12</h1>
<div id="question-6" class="section level3">
<h3>Question</h3>
<p>You have already written an R function for Exercise 9.4 (page277, Statistical Computing with R). Rewrite an Rcpp function for the same task.</p>
<p>Compare the generated random numbers by the two functions using qqplot.</p>
<p>Campare the computation time of the two functions with microbenchmark.</p>
<p>Comments your results.</p>
</div>
<div id="answer-21" class="section level3">
<h3>Answer</h3>
<div class="sourceCode" id="cb156"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb156-1" title="1"><span class="co">#the function written before</span></a>
<a class="sourceLine" id="cb156-2" title="2"><span class="kw">library</span>(kableExtra)</a>
<a class="sourceLine" id="cb156-3" title="3"><span class="kw">library</span>(GeneralizedHyperbolic)</a>
<a class="sourceLine" id="cb156-4" title="4">rw.Metropolis &lt;-<span class="st"> </span><span class="cf">function</span>(sigma,x0,N) {</a>
<a class="sourceLine" id="cb156-5" title="5">x &lt;-<span class="st"> </span><span class="kw">numeric</span>(N)</a>
<a class="sourceLine" id="cb156-6" title="6">x[<span class="dv">1</span>] &lt;-<span class="st"> </span>x0</a>
<a class="sourceLine" id="cb156-7" title="7">u &lt;-<span class="st"> </span><span class="kw">runif</span>(N)</a>
<a class="sourceLine" id="cb156-8" title="8">k &lt;-<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb156-9" title="9"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>N) {</a>
<a class="sourceLine" id="cb156-10" title="10">y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">1</span>, x[i<span class="dv">-1</span>], sigma)</a>
<a class="sourceLine" id="cb156-11" title="11"><span class="cf">if</span> (u[i] <span class="op">&lt;=</span><span class="st"> </span><span class="kw">exp</span>(<span class="kw">abs</span>(x[i<span class="dv">-1</span>]) <span class="op">-</span><span class="st"> </span><span class="kw">abs</span>(y))){</a>
<a class="sourceLine" id="cb156-12" title="12">x[i] &lt;-<span class="st"> </span>y </a>
<a class="sourceLine" id="cb156-13" title="13">k &lt;-<span class="st"> </span>k <span class="op">+</span><span class="st"> </span><span class="dv">1</span>}</a>
<a class="sourceLine" id="cb156-14" title="14"><span class="cf">else</span> {</a>
<a class="sourceLine" id="cb156-15" title="15">x[i] &lt;-<span class="st"> </span>x[i<span class="dv">-1</span>]</a>
<a class="sourceLine" id="cb156-16" title="16"></a>
<a class="sourceLine" id="cb156-17" title="17">} }</a>
<a class="sourceLine" id="cb156-18" title="18"><span class="kw">return</span>(<span class="kw">list</span>(<span class="dt">x=</span>x, <span class="dt">k=</span>k))</a>
<a class="sourceLine" id="cb156-19" title="19">}</a>
<a class="sourceLine" id="cb156-20" title="20"></a>
<a class="sourceLine" id="cb156-21" title="21"><span class="co">#the function using Rcpp</span></a>
<a class="sourceLine" id="cb156-22" title="22"><span class="kw">library</span>(Rcpp)</a>
<a class="sourceLine" id="cb156-23" title="23"><span class="kw">cppFunction</span>(<span class="st">&#39;List rw_Metropolis(double sigma, double x0, int N) {</span></a>
<a class="sourceLine" id="cb156-24" title="24"><span class="st">NumericVector x(N);</span></a>
<a class="sourceLine" id="cb156-25" title="25"><span class="st">x[0] = x0;</span></a>
<a class="sourceLine" id="cb156-26" title="26"><span class="st">int k = 0;</span></a>
<a class="sourceLine" id="cb156-27" title="27"><span class="st">for (int i = 1;i &lt; N;i++) {</span></a>
<a class="sourceLine" id="cb156-28" title="28"><span class="st">double u = runif(1)[0];</span></a>
<a class="sourceLine" id="cb156-29" title="29"><span class="st">double y = rnorm(1, x[i-1], sigma)[0];</span></a>
<a class="sourceLine" id="cb156-30" title="30"><span class="st">if (u &lt;= exp(abs(x[i-1]) - abs(y))){</span></a>
<a class="sourceLine" id="cb156-31" title="31"><span class="st">x[i] = y;</span></a>
<a class="sourceLine" id="cb156-32" title="32"><span class="st">k = k + 1;}</span></a>
<a class="sourceLine" id="cb156-33" title="33"><span class="st">else </span></a>
<a class="sourceLine" id="cb156-34" title="34"><span class="st">x[i] = x[i-1];</span></a>
<a class="sourceLine" id="cb156-35" title="35"><span class="st">}</span></a>
<a class="sourceLine" id="cb156-36" title="36"><span class="st">List result = List::create(x,k);</span></a>
<a class="sourceLine" id="cb156-37" title="37"><span class="st">return(result);</span></a>
<a class="sourceLine" id="cb156-38" title="38"><span class="st">}&#39;</span>)</a>
<a class="sourceLine" id="cb156-39" title="39"></a>
<a class="sourceLine" id="cb156-40" title="40"><span class="co">#generate random samples</span></a>
<a class="sourceLine" id="cb156-41" title="41"><span class="kw">set.seed</span>(<span class="dv">123</span>)</a>
<a class="sourceLine" id="cb156-42" title="42">N &lt;-<span class="st"> </span><span class="dv">1000</span></a>
<a class="sourceLine" id="cb156-43" title="43">sigma &lt;-<span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb156-44" title="44">x0 &lt;-<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb156-45" title="45">sample1 &lt;-<span class="st"> </span><span class="kw">rw.Metropolis</span>(sigma,x0,N)<span class="op">$</span>x</a>
<a class="sourceLine" id="cb156-46" title="46">sample2 &lt;-<span class="st"> </span><span class="kw">rw_Metropolis</span>(sigma,x0,N)[[<span class="dv">1</span>]]</a>
<a class="sourceLine" id="cb156-47" title="47"></a>
<a class="sourceLine" id="cb156-48" title="48"><span class="co">#qq plot</span></a>
<a class="sourceLine" id="cb156-49" title="49"><span class="kw">library</span>(car)</a></code></pre></div>
<pre><code>## 载入需要的程辑包：carData</code></pre>
<pre><code>## 
## 载入程辑包：&#39;car&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:VGAM&#39;:
## 
##     logit</code></pre>
<pre><code>## The following object is masked from &#39;package:DAAG&#39;:
## 
##     vif</code></pre>
<pre><code>## The following object is masked from &#39;package:boot&#39;:
## 
##     logit</code></pre>
<div class="sourceCode" id="cb162"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb162-1" title="1"><span class="kw">qqplot</span>(sample1, sample2, <span class="dt">xlab =</span> <span class="st">&quot;the samples using R&quot;</span>,</a>
<a class="sourceLine" id="cb162-2" title="2">       <span class="dt">ylab =</span> <span class="st">&quot;the samples using Rcpp&quot;</span>)</a>
<a class="sourceLine" id="cb162-3" title="3">x &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="op">-</span><span class="dv">4</span>,<span class="dv">4</span>,.<span class="dv">01</span>)</a>
<a class="sourceLine" id="cb162-4" title="4"><span class="kw">lines</span>(x,x,<span class="dt">col =</span> <span class="st">&quot;red&quot;</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb163"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb163-1" title="1"><span class="co">#Campare the computation time</span></a>
<a class="sourceLine" id="cb163-2" title="2"><span class="kw">library</span>(microbenchmark)</a>
<a class="sourceLine" id="cb163-3" title="3">ts &lt;-<span class="st"> </span><span class="kw">microbenchmark</span>(<span class="dt">rw1 =</span> <span class="kw">rw.Metropolis</span>(sigma,x0,N),<span class="dt">rw2 =</span> <span class="kw">rw_Metropolis</span>(sigma,x0,N))</a>
<a class="sourceLine" id="cb163-4" title="4"><span class="kw">summary</span>(ts)[,<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">6</span>)]</a></code></pre></div>
<pre><code>##   expr      lq median      uq
## 1  rw1 1830.30 1866.3 2225.75
## 2  rw2  129.75  131.2  138.75</code></pre>
<div id="conclusion-we-can-see-that-the-qq-plot-is-close-to-y-xwhich-means-the-samples-generated-by-two-samplers-are-quite-similar.by-computing-the-computation-timethe-time-of-sampler-using-r-is-much-more-than-that-of-sampler-using-rcppso-rcpp-gives-higher-performance-computation." class="section level5">
<h5><strong>Conclusion :</strong>We can see that the qq plot is close to y = x,which means the samples generated by two samplers are quite similar.By computing the computation time,the time of sampler using R is much more than that of sampler using Rcpp,so Rcpp gives higher performance computation.</h5>
</div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
